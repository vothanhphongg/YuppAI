var popularcaptcha=function(){"use strict";function Ct(e){return e}globalThis.browser?.runtime?.id==null?globalThis.chrome:globalThis.browser;const Se=!1,ie={equals:(e,t)=>e===t};let Ce=me;const K=1,j=2;var Y=null;let Q=null,Te=null,P=null,I=null,N=null,W=0;function le(e,t){t=t?Object.assign({},ie,t):ie;const r={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=n=>(typeof n=="function"&&(n=n(r.value)),ce(r,n));return[Re.bind(r),s]}function Pe(e){if(P===null)return e();const t=P;P=null;try{return e()}finally{P=t}}function Re(){if(this.sources&&this.state)if(this.state===K)ue(this);else{const e=I;I=null,H(()=>X(this)),I=e}if(P){const e=this.observers?this.observers.length:0;P.sources?(P.sources.push(this),P.sourceSlots.push(e)):(P.sources=[this],P.sourceSlots=[e]),this.observers?(this.observers.push(P),this.observerSlots.push(P.sources.length-1)):(this.observers=[P],this.observerSlots=[P.sources.length-1])}return this.value}function ce(e,t,r){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&H(()=>{for(let n=0;n<e.observers.length;n+=1){const o=e.observers[n],l=Q&&Q.running;l&&Q.disposed.has(o),(l?!o.tState:!o.state)&&(o.pure?I.push(o):N.push(o),o.observers&&de(o)),l||(o.state=K)}if(I.length>1e6)throw I=[],new Error})),t}function ue(e){if(!e.fn)return;G(e);const t=W;Ie(e,e.value,t)}function Ie(e,t,r){let s;const n=Y,o=P;P=Y=e;try{s=e.fn(t)}catch(l){return e.pure&&(e.state=K,e.owned&&e.owned.forEach(G),e.owned=null),e.updatedAt=r+1,fe(l)}finally{P=o,Y=n}(!e.updatedAt||e.updatedAt<=r)&&(e.updatedAt!=null&&"observers"in e?ce(e,s):e.value=s,e.updatedAt=r)}function ge(e){if(e.state===0)return;if(e.state===j)return X(e);if(e.suspense&&Pe(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<W);)e.state&&t.push(e);for(let r=t.length-1;r>=0;r--)if(e=t[r],e.state===K)ue(e);else if(e.state===j){const s=I;I=null,H(()=>X(e,t[0])),I=s}}function H(e,t){if(I)return e();let r=!1;I=[],N?r=!0:N=[],W++;try{const s=e();return Me(r),s}catch(s){r||(N=null),I=null,fe(s)}}function Me(e){if(I&&(me(I),I=null),e)return;const t=N;N=null,t.length&&H(()=>Ce(t))}function me(e){for(let t=0;t<e.length;t++)ge(e[t])}function X(e,t){e.state=0;for(let r=0;r<e.sources.length;r+=1){const s=e.sources[r];if(s.sources){const n=s.state;n===K?s!==t&&(!s.updatedAt||s.updatedAt<W)&&ge(s):n===j&&X(s,t)}}}function de(e){for(let t=0;t<e.observers.length;t+=1){const r=e.observers[t];r.state||(r.state=j,r.pure?I.push(r):N.push(r),r.observers&&de(r))}}function G(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),s=e.sourceSlots.pop(),n=r.observers;if(n&&n.length){const o=n.pop(),l=r.observerSlots.pop();s<n.length&&(o.sourceSlots[l]=s,n[s]=o,r.observerSlots[s]=l)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)G(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)G(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Oe(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function fe(e,t=Y){throw Oe(e)}const Le="0.2.1",_e=(e,t)=>{const r=document.createElement("div");r.style.cssText="position:fixed;top:8%;left:0;background-color:rgba(0,0,0,.6);padding:2px;color:#fff;font:calc(14px + .5vw) 'Arial',sans-serif;font-weight:bold;text-transform:uppercase;letter-spacing:1px;z-index:9999;transition:all 1s;animation:slideIn 1s forwards",r.innerHTML=`<p>${e}. Retrying in..<span id="countdown">${t}</span></p>`,document.body.appendChild(r),(()=>{const o=document.getElementById("countdown");if(!o)return;let l=t;const x=setInterval(()=>{l--,o.textContent=l,l<=0&&clearInterval(x)},1e3)})();const n=document.createElement("style");n.innerHTML="@keyframes slideIn{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}@keyframes slideOut{0%{transform:translateX(0)}100%{transform:translateX(100%)}}",document.head.appendChild(n),setTimeout(()=>{r.style.animation="slideOut 1s forwards",setTimeout(()=>{document.body.removeChild(r)},1e3)},t*1e3)},q=e=>document.querySelector(e),he=e=>document.querySelectorAll(e);function Ae(){return q(".task-answers")!==null}function pe(){return he(".task-image .image").length===9}function be(){return q(".bounding-box-example")!==null}function $e(){return q(".challenge-header")!==null&&q(".bounding-box-example")===null&&q(".task-grid")==null}function Fe(){const e=document.body.getBoundingClientRect();return e?.width===0||e?.height===0?!1:document.querySelector("div.check")!==null}function D(e){return new Promise(t=>setTimeout(t,e))}function Ue(e,t){return Math.floor(Math.random()*(t-e)+e)}function Be(){try{const e=document.querySelector("div.check");return e&&e.style.display==="block"}catch(e){return console.error(e),!1}}async function Ne(e){const t=await(await fetch(e,{headers:{"if-none-match":'"CFDAD5AA0CE4A3068FF1CABAC59E4D9D"'},host:"https://domain.com"})).blob();return await qe(t)}async function qe(e){return new Promise(t=>{const r=new FileReader;r.readAsDataURL(e),r.addEventListener("loadend",()=>{const s=r.result.replace(/^data:image\/(png|jpeg);base64,/,"");t(s)}),r.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}async function we(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch the URL: ${e}`);const r=await t.blob();return new Promise((s,n)=>{const o=new FileReader;o.readAsDataURL(r),o.addEventListener("loadend",()=>{s(o.result.replace(/^data:image\/(png|jpeg);base64,/,""))}),o.addEventListener("error",()=>{console.error("❌ Failed to read blob as base64"),n("Failed to read blob")})})}catch(t){return console.error(`❌ Failed to convert URL to base64: ${e}`,t),null}}function De(){document.querySelectorAll("iframe").forEach(t=>{t.src=t.src})}async function Ke(){be()?(await D(200),document.querySelector(".display-language.button").click(),await D(100),document.querySelector(".language-selector .option:nth-child(23)").click()):pe()?(await D(100),document.querySelector(".language-selector .option:nth-child(23)").click()):Ae()&&(document.querySelector(".display-language.button").click(),await D(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await D(200))}function je(){document.querySelector(".button-submit").click()}async function Ye(){const e=navigator.userAgent;let t,r=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],`IE ${t[1]||""}`):r[1]==="Chrome"&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=e.match(/version\/(\d+)/i))!=null&&r.splice(1,1,t[1]),{version:r,platform:navigator.platform})}function We(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}function ee(e){["mouseover","mousedown","mouseup","click"].forEach(t=>{if(e.fireEvent)e.fireEvent("on"+t);else{const r=document.createEvent("MouseEvents");r.initEvent(t,!0,!1),e.dispatchEvent(r)}})}function te(e,t,r,s,n,o,l){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,clientX:r,clientY:s,buttons:n,button:o,pressure:l}))}async function He(e,t){const r=document.querySelector("canvas");if(e!==void 0)for(const{start:s,end:n}of e)if(Array.isArray(s)&&s.length!==0&&Array.isArray(n)&&n.length!==0){const[o,l]=s,[x,S]=n,d=r.getBoundingClientRect(),g=o+d.left,f=l+d.top,L=x+d.left,p=S+d.top;te(r,"mousedown",g,f,1,0,1),await new Promise(v=>setTimeout(v,t));const h=L-g,y=p-f,E=Math.sqrt(h**2+y**2),k=Math.round(E/6),T=h/k,F=y/k;for(let v=1;v<=k;v++){const U=g+T*v,a=f+F*v;te(r,"mousemove",U,a,1,0,1),await new Promise(c=>setTimeout(c,50))}te(r,"mouseup",L,p,0,0,0)}else i.$(".button-submit").click();else i.$(".button-submit").click()}async function Xe(e){function t(o,l,x){const S=o.getBoundingClientRect(),d=["mouseover","mousedown","mouseup","click"],g={clientX:l+S.left,clientY:x+S.top,bubbles:!0};for(let f=0;f<d.length;f++){const L=new MouseEvent(d[f],g);o.dispatchEvent(L)}}const r=document.querySelector("canvas");r.addEventListener("mousedown",o=>{const l=r.getBoundingClientRect();o.clientX-l.left,o.clientY-l.top});const[s,n]=e;t(r,s,n),await i.sleep(300)}async function Ge(e,t){const r=(await chrome.storage.local.get("customEndpoint")).customEndpoint;return t==="custom"?`https://${r}/${e}`:"https://api.captchasonic.com/createTask"}async function Ve(e){for(const t of e){const r=[...document.querySelectorAll(".answer-text")].find(s=>s.outerText===t);ee(r),[...document.querySelectorAll(".answer-example")].some(s=>s.style.backgroundColor==="rgb(116, 116, 116)")||ee(r)}}async function ze(){const e=document.querySelector("canvas");if(!e)return null;const[t,r]=[e.width,e.height],n=e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,t,r,{willReadFrequently:!0});if((p=>{const h=p.data;for(let y=0;y<h.length;y+=4){const E=h[y],k=h[y+1],T=h[y+2];if(E!==k||k!==T)return!1}return!0})(n))return null;const l=parseInt(e.style.width,10),x=parseInt(e.style.height,10);if(l<=0||x<=0)return null;const S=Math.min(l/t,x/r),[d,g]=[t*S,r*S],f=document.createElement("canvas");return Object.assign(f,{width:d,height:g}),f.getContext("2d",{willReadFrequently:!0}).drawImage(e,0,0,t,r,0,0,d,g),f.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/,"")}function Je(e){return[...document.querySelectorAll(`${e}`)].map(t=>t.style.backgroundImage.replace(/url\("|"\)/g,""))}function Ze(e){return Promise.all(e.map(async(t,r)=>(e[r]=await we(t),e[r])))}async function Qe(e,t,r){const s=e.getBoundingClientRect(),n=s.left+window.scrollX,o=s.top+window.scrollY,l=n+t,x=o+r,S=new MouseEvent("mousedown",{clientX:n,clientY:o,bubbles:!0});e.dispatchEvent(S),await new Promise(p=>setTimeout(p,1e3));const d=20,g=(l-n)/d,f=(x-o)/d;for(let p=1;p<=d;p++){const h=n+g*p,y=o+f*p,E=new MouseEvent("mousemove",{clientX:h,clientY:y,bubbles:!0});e.dispatchEvent(E),await new Promise(k=>setTimeout(k,150))}const L=new MouseEvent("mouseup",{clientX:l,clientY:x,bubbles:!0});e.dispatchEvent(L),await new Promise(p=>setTimeout(p,1e3))}async function et(e,t,r){try{const n=await(await fetch(e,{method:"POST",headers:r,body:JSON.stringify(t)})).json();if(n.code!==200){const o=n.msg;if(o){if(n.code===1||n.code===10||n.code===18||n.code===110){chrome.runtime.sendMessage({action:o}),stop=!0;return}if(n.code===17||n.code===19||n.code===429){chrome.runtime.sendMessage({action:o}),stop=!0;return}if([4,3,12,13,14,115].includes(n.code))return document.querySelector(".geetest_refresh").click(),null}}return n}catch(s){throw console.error("Error fetching coordinates:",s),s}}async function tt(e){try{const t=await fetch("https://feedback.captchasonic.com/extFeedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const r=await t.json();return console.log("Success:",r),r}catch(t){return console.error("Error sending feedback:",t),null}}function rt(e,t){const r=document.querySelector(e);if(!r){console.warn(`Element not found: ${e}`);return}return new MutationObserver(n=>{n.forEach(o=>{if(o.attributeName==="aria-hidden"){const l=r.getAttribute("aria-hidden")==="true";window.postMessage({type:"ariaHiddenChange",value:l},"*"),typeof t=="function"&&t(l)}})}).observe(r,{attributes:!0,attributeFilter:["aria-hidden"]}),r.getAttribute("aria-hidden")==="true"}function st(e,t){const r=`${e}_feedback`;chrome.storage.local.get(`${e}_solved`,s=>{s[`${e}_solved`],chrome.storage.local.get([r],n=>{const o=n[r]||[];if(o.some(x=>x.fail_report===!0)){const x=o.map(g=>g.data),d={type:"feedback",payload:{apiKey:t,data:x,pass:!1}};x.length>0&&chrome.runtime.sendMessage(d,g=>{chrome.storage.local.remove([r,`${e}_solved`,`${e}_feedback`,`${e}_hasRun`],()=>{})})}chrome.storage.local.remove([r,`${e}_solved`],()=>{})})})}function nt(e,t){const r=`${e}_feedback`;chrome.storage.local.get(`${e}_solved`,s=>{s[`${e}_solved`],chrome.storage.local.get([r],n=>{const o=n[r]||[];if(o.some(x=>x.pass_report===!0)){const x=o.map(g=>g.data),d={type:"feedback",payload:{apiKey:t,data:x,pass:!0}};x.length>0&&chrome.runtime.sendMessage(d,g=>{chrome.storage.local.remove([r,`${e}_solved`,`${e}_feedback`],()=>{})})}chrome.storage.local.remove([r,`${e}_solved`],()=>{})})})}async function ot(e,t=50,r=.1){return new Promise((s,n)=>{const o=atob(e),l=new Array(o.length);for(let f=0;f<o.length;f++)l[f]=o.charCodeAt(f);const x=new Uint8Array(l),S=new Blob([x],{type:"image/jpeg"}),d=URL.createObjectURL(S),g=new Image;g.onload=()=>{URL.revokeObjectURL(d);const f=document.createElement("canvas");f.width=g.width,f.height=g.height,f.getContext("2d").drawImage(g,0,0);let p=.9,h,y;do h=f.toDataURL("image/jpeg",p),y=h.length*3/4/1024,p-=.05;while(y>t&&p>=r);y>t?n(new Error(`Couldn't compress below ${t}KB. Final size: ${y.toFixed(2)}KB`)):s(h.split(",")[1])},g.onerror=()=>{URL.revokeObjectURL(d),n(new Error("Image load failed (possibly corrupt base64)"))},g.src=d})}async function at(e){return e.replace(/^data:image\/\w+;base64,/,"")}async function it(e){return new Promise(t=>{chrome.runtime.sendMessage({type:"GET_IMAGE_BASE64",payload:{url:e}},r=>{r?.success?t(r.data):t(null)})})}function lt(){return new Promise((e,t)=>{chrome.runtime.sendMessage({action:"getActiveTabUrl"},r=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(r.url)})})}const i={version:Le,$:q,$$:he,isMulti:Ae,isGrid:pe,isBbox:be,isBboxDD:$e,isWidget:Fe,sleep:D,randTimer:Ue,isSolved:Be,countdownNotif:_e,getBase64FromUrl:we,refreshIframes:De,getEn:Ke,skip:je,getBrowser:Ye,shuffle:We,fireMouseEvents:ee,getCanvas:Xe,handleCanvasDD:He,getApi:Ge,clickMatchingElement:Ve,sliceOG:ze,updateExamples:Ze,getExamples:Je,solveGeetestCaptcha:Qe,sendCoordinatesRequest:et,geeFetchImage:Ne,sendFeedback:tt,observeAriaHidden:rt,handleCaptchaFeedback:st,handleCaptchaFeedbackOnSuccess:nt,compressPureBase64Image:ot,stripBase64Prefix:at,fetchBase64Image:it,getActiveTabUrl:lt};async function ct(e,t,r){if(!e()||e().ACTIVE===!1||e().OPTIONS[r].ENABLED===!1)return!1;function s(l,x){try{return x.some(d=>l.includes(d))}catch(S){return console.error("Error checking blacklist:",S),!1}}const n=e().BLACKLIST||[];return!(s(t(),n)&&e().BLACKLISTENABLED)}const ut={matches:["<all_urls>"],allFrames:!0,match_about_blank:!1,async main(){let e;try{e=window.top.document.location.href}catch{e=window.location.href}const[t]=le(e),[r,s]=le(await chrome.storage.local.get("settings"));s(r().settings),chrome.runtime.onMessage.addListener((l,x,S)=>{if(l.action==="POPULARCAPTCHA_refresh_iframes"){const d=[...document.querySelectorAll("[src*=newassets]")];if(d)for(const g of d){const f=g.src;g.src="about:blank",setTimeout(()=>{g.src=f},100)}for(let g=0;g<d.length;g++){const f=d[g];try{f.contentWindow.location.origin!==window.location.origin&&(f.src=f.src)}catch{f.src=f.src}}}}),await ct(r,t,"POPULARCAPTCHA")&&(async()=>{let l=!1;r().APIKEY;const x=()=>!navigator.onLine||l||r().APIKEY===void 0||r().APIKEY==="";(()=>{const h=document.querySelector(".display-error");if(!h)return;new MutationObserver(E=>{for(const k of E)if(k.attributeName==="aria-hidden"&&!(h.getAttribute("aria-hidden")==="true")){let v=new URLSearchParams(location.href).get("id");v&&(chrome.storage.local.set({[`${v}_solved`]:!1}),i.handleCaptchaFeedback(v,r().APIKEY))}}).observe(h,{attributes:!0,attributeFilter:["aria-hidden"]})})();let d=new URLSearchParams(location.href).get("id");for(d&&chrome.storage.local.get(null,p=>{Object.keys(p).forEach(h=>{h.endsWith("_hasRun")&&chrome.storage.local.remove(h),h.endsWith("_feedback")&&chrome.storage.local.remove(h),h.endsWith("_solved")&&chrome.storage.local.remove(h)}),chrome.storage.local.set({[`${d}_hasRun`]:!1})});!x();){if(await i.sleep(1e3),i.isWidget()){if(i.isSolved()&&r().OPTIONS.POPULARCAPTCHA.ALWAYSSOLVE===!1)break;r().AUTOOPENENABLED===!0&&r().OPTIONS.POPULARCAPTCHA.AUTOOPEN===!0&&i.$("#checkbox")?.click()}else r().OPTIONS.POPULARCAPTCHA.AUTOSOLVE&&i.$("h2.prompt-text")!==null&&(await i.sleep(1e3),await f());let p=i.$("#checkbox");if(p&&!l&&p.getAttribute("aria-checked")==="true")try{let E=new URLSearchParams(location.href).get("id");E&&chrome.storage.local.get(`${E}_hasRun`,k=>{if(chrome.runtime.lastError){console.error("Error accessing storage:",chrome.runtime.lastError);return}if(k[`${E}_hasRun`]===!0)return;const T=r()?.APIKEY;if(!T){console.error("API Key is missing or undefined.");return}i.handleCaptchaFeedbackOnSuccess(E,T),chrome.storage.local.set({[`${E}_hasRun`]:!0},()=>{chrome.runtime.lastError&&console.error("Error saving to storage:",chrome.runtime.lastError)})})}catch(y){console.error("Error processing checkbox logic:",y)}}async function g(){i.isBbox()?(await i.sleep(200),document.querySelector(".display-language.button")?.click(),await i.sleep(100),document.querySelector(".language-selector .option:nth-child(23)")?.click()):i.isGrid()?(await i.sleep(100),document.querySelector(".language-selector .option:nth-child(23)")?.click()):i.isMulti()?(document.querySelector(".display-language.button")?.click(),await i.sleep(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await i.sleep(200)):i.isBboxDD()&&(document.querySelector("#display-language.button")?.click(),await i.sleep(200),document.querySelector(".language-selector .option:nth-child(23)")?.click(),await i.sleep(200))}async function f(){r()?.OPTIONS?.POPULARCAPTCHA?.ENGLISH&&(document.documentElement.lang||navigator.language)!=="en"&&await g();let p=[];if(p.length!==0)return;const{target:h,cells:y,images:E,examples:k,choices:T}=await L();if(!r().OPTIONS.POPULARCAPTCHA.AUTOSOLVE||Object.keys(E).length===0||h==="")return;const F=new URLSearchParams(location.hash),v=i.isMulti()?"objectTag":i.isBbox()?"objectClick":i.isBboxDD()?"objectDrag":"objectClassify";p=E;const U={type:"networkRequest",payload:{url:"https://api.captchasonic.com/createTask",method:"POST",headers:{"Content-Type":"application/json",apikey:r().APIKEY,appid:0},body:JSON.stringify({apiKey:r().APIKEY,source:"chrome",version:i.version,appID:0,task:{type:"PopularCaptchaImage",queries:E,examples:k,question:h,screenshot:!!i.isBboxDD(),questionType:v,websiteURL:F.get("host"),websiteKEY:F.get("sitekey"),choices:i.isMulti()?T:[]}})}};try{await a(U)}catch(u){console.error("Message processing failed:",u)}function a(u){return new Promise((w,R)=>{let $=!1;chrome.runtime.sendMessage(u,async M=>{try{if($){console.warn("Already processing a request");return}if($=!0,!M?.success){const oe=new Error("Failed to fetch response");throw oe.response=M,oe}const B=M.data.meta,ne=M.data,ve=ne.code,yt=ne.msg;if(B){let vt=function(Et,kt){const ae=`${Et}_feedback`;chrome.storage.local.get([ae],St=>{const ke=St[ae]||[];ke.push(kt),chrome.storage.local.set({[ae]:ke})})},Ee=new URLSearchParams(location.href).get("id");Ee&&vt(Ee,B)}if(ve!==200){await c(ve,yt,M.retryAfterSec),$=!1,w();return}await A(ne),await i.sleep(500),await i.$(".button-submit").click(),b(),$=!1,w()}catch(B){$=!1,console.error("Error processing message:",B),R(B)}}),setTimeout(()=>{$&&($=!1,R(new Error("Request timed out")))},3e4)})}async function c(u,w,R){if(!w){console.warn(`Unknown error code: ${u}`);return}if([1,10,18,110].includes(u)){chrome.runtime.sendMessage({action:w}),l=!0;return}if([17,19,429].includes(u)){chrome.runtime.sendMessage({action:w}),l=!0;return}[4,3,12,13,14,115].includes(u)&&i.$(".button-submit").click()}async function A(u){await i.sleep(500),i.isMulti()?await C(u.answers):i.isGrid()?await O(u.answers):i.isBbox()?await _(u.answers[0]):i.isBboxDD()?await m(u.answers):console.warn("Unrecognized response type")}function b(){p=[]}async function C(u){if(!u||u.length===0){console.warn("No answers provided for Multi");return}await i.clickMatchingElement(u[0])}async function O(u){if(!Array.isArray(u)||u.length<9){console.warn("Insufficient answers for Grid");return}const w=i.randTimer(150,250);for(let R=0;R<u.length;R++)u[R]&&(y[R].click(),await i.sleep(w))}async function _(u){if(!Array.isArray(u)||u.length===0){console.warn("No answers provided for Bbox");return}for(const w of u){const R=[w.x,w.y];await i.getCanvas(R)}}async function m(u){if(!Array.isArray(u)||u.length===0){i.$(".button-submit").click();return}for(const w of u)await i.handleCanvasDD(w,1e3)}}function L(){return new Promise(p=>{const h=setInterval(async()=>{const y=i.$(".prompt-text")?.textContent;if(!y||l)return;const E=i.$$(".task-image .image");let k=[],T={};if(i.isGrid()||i.isMulti())l=!0,await Promise.all([...E].map(async(v,U)=>{const a=v.style.backgroundImage.replace(/url\("|"\)/g,"");if(!(b=>{try{return new URL(b),!0}catch{return!1}})(a)){console.warn(`Invalid URL detected: ${a}`);return}await i.getBase64FromUrl(a)&&(T[U]=await i.getBase64FromUrl(a))}),i),k=i.getExamples(".challenge-example .image .image");else if(i.isBbox()){const v=await i.sliceOG();if(v)T[0]=v;else return;k=i.getExamples(".example-image .image")}else if(i.isBboxDD()){const v=await i.sliceOG();if(v)T[0]=v;else return}T=Object.values(T);const F={target:y,cells:E,images:T,examples:await i.updateExamples(k),choices:[...document.querySelectorAll(".answer-text")].map(v=>v.outerText)};clearInterval(h),l=!1,p(F)},1e3)})}})()}};function gt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var V={exports:{}},mt=V.exports,xe;function dt(){return xe||(xe=1,function(e,t){(function(r,s){s(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:mt,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const s="The message port closed before a response was received.",n=o=>{const l={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(l).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class x extends WeakMap{constructor(c,A=void 0){super(A),this.createItem=c}get(c){return this.has(c)||this.set(c,this.createItem(c)),super.get(c)}}const S=a=>a&&typeof a=="object"&&typeof a.then=="function",d=(a,c)=>(...A)=>{o.runtime.lastError?a.reject(new Error(o.runtime.lastError.message)):c.singleCallbackArg||A.length<=1&&c.singleCallbackArg!==!1?a.resolve(A[0]):a.resolve(A)},g=a=>a==1?"argument":"arguments",f=(a,c)=>function(b,...C){if(C.length<c.minArgs)throw new Error(`Expected at least ${c.minArgs} ${g(c.minArgs)} for ${a}(), got ${C.length}`);if(C.length>c.maxArgs)throw new Error(`Expected at most ${c.maxArgs} ${g(c.maxArgs)} for ${a}(), got ${C.length}`);return new Promise((O,_)=>{if(c.fallbackToNoCallback)try{b[a](...C,d({resolve:O,reject:_},c))}catch(m){console.warn(`${a} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,m),b[a](...C),c.fallbackToNoCallback=!1,c.noCallback=!0,O()}else c.noCallback?(b[a](...C),O()):b[a](...C,d({resolve:O,reject:_},c))})},L=(a,c,A)=>new Proxy(c,{apply(b,C,O){return A.call(C,a,...O)}});let p=Function.call.bind(Object.prototype.hasOwnProperty);const h=(a,c={},A={})=>{let b=Object.create(null),C={has(_,m){return m in a||m in b},get(_,m,u){if(m in b)return b[m];if(!(m in a))return;let w=a[m];if(typeof w=="function")if(typeof c[m]=="function")w=L(a,a[m],c[m]);else if(p(A,m)){let R=f(m,A[m]);w=L(a,a[m],R)}else w=w.bind(a);else if(typeof w=="object"&&w!==null&&(p(c,m)||p(A,m)))w=h(w,c[m],A[m]);else if(p(A,"*"))w=h(w,c[m],A["*"]);else return Object.defineProperty(b,m,{configurable:!0,enumerable:!0,get(){return a[m]},set(R){a[m]=R}}),w;return b[m]=w,w},set(_,m,u,w){return m in b?b[m]=u:a[m]=u,!0},defineProperty(_,m,u){return Reflect.defineProperty(b,m,u)},deleteProperty(_,m){return Reflect.deleteProperty(b,m)}},O=Object.create(a);return new Proxy(O,C)},y=a=>({addListener(c,A,...b){c.addListener(a.get(A),...b)},hasListener(c,A){return c.hasListener(a.get(A))},removeListener(c,A){c.removeListener(a.get(A))}}),E=new x(a=>typeof a!="function"?a:function(A){const b=h(A,{},{getContent:{minArgs:0,maxArgs:0}});a(b)}),k=new x(a=>typeof a!="function"?a:function(A,b,C){let O=!1,_,m=new Promise($=>{_=function(M){O=!0,$(M)}}),u;try{u=a(A,b,_)}catch($){u=Promise.reject($)}const w=u!==!0&&S(u);if(u!==!0&&!w&&!O)return!1;const R=$=>{$.then(M=>{C(M)},M=>{let B;M&&(M instanceof Error||typeof M.message=="string")?B=M.message:B="An unexpected error occurred",C({__mozWebExtensionPolyfillReject__:!0,message:B})}).catch(M=>{console.error("Failed to send onMessage rejected reply",M)})};return R(w?u:m),!0}),T=({reject:a,resolve:c},A)=>{o.runtime.lastError?o.runtime.lastError.message===s?c():a(new Error(o.runtime.lastError.message)):A&&A.__mozWebExtensionPolyfillReject__?a(new Error(A.message)):c(A)},F=(a,c,A,...b)=>{if(b.length<c.minArgs)throw new Error(`Expected at least ${c.minArgs} ${g(c.minArgs)} for ${a}(), got ${b.length}`);if(b.length>c.maxArgs)throw new Error(`Expected at most ${c.maxArgs} ${g(c.maxArgs)} for ${a}(), got ${b.length}`);return new Promise((C,O)=>{const _=T.bind(null,{resolve:C,reject:O});b.push(_),A.sendMessage(...b)})},v={devtools:{network:{onRequestFinished:y(E)}},runtime:{onMessage:y(k),onMessageExternal:y(k),sendMessage:F.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:F.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},U={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return l.privacy={network:{"*":U},services:{"*":U},websites:{"*":U}},h(o,v,l)};r.exports=n(chrome)}})}(V)),V.exports}var ft=dt();const ye=gt(ft);function z(e,...t){}const ht={debug:(...e)=>z(console.debug,...e),log:(...e)=>z(console.log,...e),warn:(...e)=>z(console.warn,...e),error:(...e)=>z(console.error,...e)};class re extends Event{constructor(t,r){super(re.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=r}static EVENT_NAME=se("wxt:locationchange")}function se(e){return`${ye?.runtime?.id}:popularCaptcha:${e}`}function At(e){let t,r;return{run(){t==null&&(r=new URL(location.href),t=e.setInterval(()=>{let s=new URL(location.href);s.href!==r.href&&(window.dispatchEvent(new re(s,r)),r=s)},1e3))}}}class J{constructor(t,r){this.contentScriptName=t,this.options=r,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=se("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=At(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return ye.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,r){const s=setInterval(()=>{this.isValid&&t()},r);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(t,r){const s=setTimeout(()=>{this.isValid&&t()},r);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(t){const r=requestAnimationFrame((...s)=>{this.isValid&&t(...s)});return this.onInvalidated(()=>cancelAnimationFrame(r)),r}requestIdleCallback(t,r){const s=requestIdleCallback((...n)=>{this.signal.aborted||t(...n)},r);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(t,r,s,n){r==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(r.startsWith("wxt:")?se(r):r,s,{...n,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),ht.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:J.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){const r=t.data?.type===J.SCRIPT_STARTED_MESSAGE_TYPE,s=t.data?.contentScriptName===this.contentScriptName,n=!this.receivedMessageIds.has(t.data?.messageId);return r&&s&&n}listenForNewerScripts(t){let r=!0;const s=n=>{if(this.verifyScriptStartedEvent(n)){this.receivedMessageIds.add(n.data.messageId);const o=r;if(r=!1,o&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}}const pt=Symbol("null");let bt=0;class wt extends Map{constructor(){super(),this._objectHashes=new WeakMap,this._symbolHashes=new Map,this._publicKeys=new Map;const[t]=arguments;if(t!=null){if(typeof t[Symbol.iterator]!="function")throw new TypeError(typeof t+" is not iterable (cannot read property Symbol(Symbol.iterator))");for(const[r,s]of t)this.set(r,s)}}_getPublicKeys(t,r=!1){if(!Array.isArray(t))throw new TypeError("The keys parameter must be an array");const s=this._getPrivateKey(t,r);let n;return s&&this._publicKeys.has(s)?n=this._publicKeys.get(s):r&&(n=[...t],this._publicKeys.set(s,n)),{privateKey:s,publicKey:n}}_getPrivateKey(t,r=!1){const s=[];for(let n of t){n===null&&(n=pt);const o=typeof n=="object"||typeof n=="function"?"_objectHashes":typeof n=="symbol"?"_symbolHashes":!1;if(!o)s.push(n);else if(this[o].has(n))s.push(this[o].get(n));else if(r){const l=`@@mkm-ref-${bt++}@@`;this[o].set(n,l),s.push(l)}else return!1}return JSON.stringify(s)}set(t,r){const{publicKey:s}=this._getPublicKeys(t,!0);return super.set(s,r)}get(t){const{publicKey:r}=this._getPublicKeys(t);return super.get(r)}has(t){const{publicKey:r}=this._getPublicKeys(t);return super.has(r)}delete(t){const{publicKey:r,privateKey:s}=this._getPublicKeys(t);return!!(r&&super.delete(r)&&this._publicKeys.delete(s))}clear(){super.clear(),this._symbolHashes.clear(),this._publicKeys.clear()}get[Symbol.toStringTag](){return"ManyKeysMap"}get size(){return super.size}}new wt;function Rt(){}function Z(e,...t){}const xt={debug:(...e)=>Z(console.debug,...e),log:(...e)=>Z(console.log,...e),warn:(...e)=>Z(console.warn,...e),error:(...e)=>Z(console.error,...e)};return(async()=>{try{const{main:e,...t}=ut,r=new J("popularCaptcha",t);return await e(r)}catch(e){throw xt.error('The content script "popularCaptcha" crashed on startup!',e),e}})()}();
popularcaptcha;
