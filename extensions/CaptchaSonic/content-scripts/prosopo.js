var prosopo=function(){"use strict";function ft(e){return e}const we=!1,ne={equals:(e,t)=>e===t};let xe=le;const U=1,j=2;var D=null;let Z=null,ye=null,k=null,M=null,$=null,Y=0;function oe(e,t){t=t?Object.assign({},ne,t):ne;const r={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=n=>(typeof n=="function"&&(n=n(r.value)),ae(r,n));return[Ee.bind(r),s]}function ve(e){if(k===null)return e();const t=k;k=null;try{return e()}finally{k=t}}function Ee(){if(this.sources&&this.state)if(this.state===U)ie(this);else{const e=M;M=null,X(()=>W(this)),M=e}if(k){const e=this.observers?this.observers.length:0;k.sources?(k.sources.push(this),k.sourceSlots.push(e)):(k.sources=[this],k.sourceSlots=[e]),this.observers?(this.observers.push(k),this.observerSlots.push(k.sources.length-1)):(this.observers=[k],this.observerSlots=[k.sources.length-1])}return this.value}function ae(e,t,r){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&X(()=>{for(let n=0;n<e.observers.length;n+=1){const o=e.observers[n],c=Z&&Z.running;c&&Z.disposed.has(o),(c?!o.tState:!o.state)&&(o.pure?M.push(o):$.push(o),o.observers&&ue(o)),c||(o.state=U)}if(M.length>1e6)throw M=[],new Error})),t}function ie(e){if(!e.fn)return;V(e);const t=Y;Se(e,e.value,t)}function Se(e,t,r){let s;const n=D,o=k;k=D=e;try{s=e.fn(t)}catch(c){return e.pure&&(e.state=U,e.owned&&e.owned.forEach(V),e.owned=null),e.updatedAt=r+1,ge(c)}finally{k=o,D=n}(!e.updatedAt||e.updatedAt<=r)&&(e.updatedAt!=null&&"observers"in e?ae(e,s):e.value=s,e.updatedAt=r)}function ce(e){if(e.state===0)return;if(e.state===j)return W(e);if(e.suspense&&ve(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Y);)e.state&&t.push(e);for(let r=t.length-1;r>=0;r--)if(e=t[r],e.state===U)ie(e);else if(e.state===j){const s=M;M=null,X(()=>W(e,t[0])),M=s}}function X(e,t){if(M)return e();let r=!1;M=[],$?r=!0:$=[],Y++;try{const s=e();return ke(r),s}catch(s){r||($=null),M=null,ge(s)}}function ke(e){if(M&&(le(M),M=null),e)return;const t=$;$=null,t.length&&X(()=>xe(t))}function le(e){for(let t=0;t<e.length;t++)ce(e[t])}function W(e,t){e.state=0;for(let r=0;r<e.sources.length;r+=1){const s=e.sources[r];if(s.sources){const n=s.state;n===U?s!==t&&(!s.updatedAt||s.updatedAt<Y)&&ce(s):n===j&&W(s,t)}}}function ue(e){for(let t=0;t<e.observers.length;t+=1){const r=e.observers[t];r.state||(r.state=j,r.pure?M.push(r):$.push(r),r.observers&&ue(r))}}function V(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),s=e.sourceSlots.pop(),n=r.observers;if(n&&n.length){const o=n.pop(),c=r.observerSlots.pop();s<n.length&&(o.sourceSlots[c]=s,n[s]=o,r.observerSlots[s]=c)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)V(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)V(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Ce(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ge(e,t=D){throw Ce(e)}const Te="0.2.1",Pe=(e,t)=>{const r=document.createElement("div");r.style.cssText="position:fixed;top:8%;left:0;background-color:rgba(0,0,0,.6);padding:2px;color:#fff;font:calc(14px + .5vw) 'Arial',sans-serif;font-weight:bold;text-transform:uppercase;letter-spacing:1px;z-index:9999;transition:all 1s;animation:slideIn 1s forwards",r.innerHTML=`<p>${e}. Retrying in..<span id="countdown">${t}</span></p>`,document.body.appendChild(r),(()=>{const o=document.getElementById("countdown");if(!o)return;let c=t;const f=setInterval(()=>{c--,o.textContent=c,c<=0&&clearInterval(f)},1e3)})();const n=document.createElement("style");n.innerHTML="@keyframes slideIn{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}@keyframes slideOut{0%{transform:translateX(0)}100%{transform:translateX(100%)}}",document.head.appendChild(n),setTimeout(()=>{r.style.animation="slideOut 1s forwards",setTimeout(()=>{document.body.removeChild(r)},1e3)},t*1e3)},L=e=>document.querySelector(e),me=e=>document.querySelectorAll(e);function de(){return L(".task-answers")!==null}function fe(){return me(".task-image .image").length===9}function he(){return L(".bounding-box-example")!==null}function Me(){return L(".challenge-header")!==null&&L(".bounding-box-example")===null&&L(".task-grid")==null}function Ie(){const e=document.body.getBoundingClientRect();return e?.width===0||e?.height===0?!1:document.querySelector("div.check")!==null}function N(e){return new Promise(t=>setTimeout(t,e))}function Re(e,t){return Math.floor(Math.random()*(t-e)+e)}function Oe(){try{const e=document.querySelector("div.check");return e&&e.style.display==="block"}catch(e){return console.error(e),!1}}async function Fe(e){const t=await(await fetch(e,{headers:{"if-none-match":'"CFDAD5AA0CE4A3068FF1CABAC59E4D9D"'},host:"https://domain.com"})).blob();return await _e(t)}async function _e(e){return new Promise(t=>{const r=new FileReader;r.readAsDataURL(e),r.addEventListener("loadend",()=>{const s=r.result.replace(/^data:image\/(png|jpeg);base64,/,"");t(s)}),r.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}async function Ae(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch the URL: ${e}`);const r=await t.blob();return new Promise((s,n)=>{const o=new FileReader;o.readAsDataURL(r),o.addEventListener("loadend",()=>{s(o.result.replace(/^data:image\/(png|jpeg);base64,/,""))}),o.addEventListener("error",()=>{console.error("❌ Failed to read blob as base64"),n("Failed to read blob")})})}catch(t){return console.error(`❌ Failed to convert URL to base64: ${e}`,t),null}}function qe(){document.querySelectorAll("iframe").forEach(t=>{t.src=t.src})}async function $e(){he()?(await N(200),document.querySelector(".display-language.button").click(),await N(100),document.querySelector(".language-selector .option:nth-child(23)").click()):fe()?(await N(100),document.querySelector(".language-selector .option:nth-child(23)").click()):de()&&(document.querySelector(".display-language.button").click(),await N(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await N(200))}function Le(){document.querySelector(".button-submit").click()}async function Ne(){const e=navigator.userAgent;let t,r=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],`IE ${t[1]||""}`):r[1]==="Chrome"&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=e.match(/version\/(\d+)/i))!=null&&r.splice(1,1,t[1]),{version:r,platform:navigator.platform})}function Be(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}function Q(e){["mouseover","mousedown","mouseup","click"].forEach(t=>{if(e.fireEvent)e.fireEvent("on"+t);else{const r=document.createEvent("MouseEvents");r.initEvent(t,!0,!1),e.dispatchEvent(r)}})}function ee(e,t,r,s,n,o,c){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,clientX:r,clientY:s,buttons:n,button:o,pressure:c}))}async function Ue(e,t){const r=document.querySelector("canvas");if(e!==void 0)for(const{start:s,end:n}of e)if(Array.isArray(s)&&s.length!==0&&Array.isArray(n)&&n.length!==0){const[o,c]=s,[f,C]=n,A=r.getBoundingClientRect(),h=o+A.left,p=c+A.top,I=f+A.left,x=C+A.top;ee(r,"mousedown",h,p,1,0,1),await new Promise(w=>setTimeout(w,t));const v=I-h,l=x-p,E=Math.sqrt(v**2+l**2),b=Math.round(E/6),y=v/b,m=l/b;for(let w=1;w<=b;w++){const T=h+y*w,a=p+m*w;ee(r,"mousemove",T,a,1,0,1),await new Promise(i=>setTimeout(i,50))}ee(r,"mouseup",I,x,0,0,0)}else _.$(".button-submit").click();else _.$(".button-submit").click()}async function Ke(e){function t(o,c,f){const C=o.getBoundingClientRect(),A=["mouseover","mousedown","mouseup","click"],h={clientX:c+C.left,clientY:f+C.top,bubbles:!0};for(let p=0;p<A.length;p++){const I=new MouseEvent(A[p],h);o.dispatchEvent(I)}}const r=document.querySelector("canvas");r.addEventListener("mousedown",o=>{const c=r.getBoundingClientRect();o.clientX-c.left,o.clientY-c.top});const[s,n]=e;t(r,s,n),await _.sleep(300)}async function je(e,t){const r=(await chrome.storage.local.get("customEndpoint")).customEndpoint;return t==="custom"?`https://${r}/${e}`:"https://api.captchasonic.com/createTask"}async function De(e){for(const t of e){const r=[...document.querySelectorAll(".answer-text")].find(s=>s.outerText===t);Q(r),[...document.querySelectorAll(".answer-example")].some(s=>s.style.backgroundColor==="rgb(116, 116, 116)")||Q(r)}}async function Ye(){const e=document.querySelector("canvas");if(!e)return null;const[t,r]=[e.width,e.height],n=e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,t,r,{willReadFrequently:!0});if((x=>{const v=x.data;for(let l=0;l<v.length;l+=4){const E=v[l],b=v[l+1],y=v[l+2];if(E!==b||b!==y)return!1}return!0})(n))return null;const c=parseInt(e.style.width,10),f=parseInt(e.style.height,10);if(c<=0||f<=0)return null;const C=Math.min(c/t,f/r),[A,h]=[t*C,r*C],p=document.createElement("canvas");return Object.assign(p,{width:A,height:h}),p.getContext("2d",{willReadFrequently:!0}).drawImage(e,0,0,t,r,0,0,A,h),p.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/,"")}function Xe(e){return[...document.querySelectorAll(`${e}`)].map(t=>t.style.backgroundImage.replace(/url\("|"\)/g,""))}function We(e){return Promise.all(e.map(async(t,r)=>(e[r]=await Ae(t),e[r])))}async function Ve(e,t,r){const s=e.getBoundingClientRect(),n=s.left+window.scrollX,o=s.top+window.scrollY,c=n+t,f=o+r,C=new MouseEvent("mousedown",{clientX:n,clientY:o,bubbles:!0});e.dispatchEvent(C),await new Promise(x=>setTimeout(x,1e3));const A=20,h=(c-n)/A,p=(f-o)/A;for(let x=1;x<=A;x++){const v=n+h*x,l=o+p*x,E=new MouseEvent("mousemove",{clientX:v,clientY:l,bubbles:!0});e.dispatchEvent(E),await new Promise(b=>setTimeout(b,150))}const I=new MouseEvent("mouseup",{clientX:c,clientY:f,bubbles:!0});e.dispatchEvent(I),await new Promise(x=>setTimeout(x,1e3))}async function He(e,t,r){try{const n=await(await fetch(e,{method:"POST",headers:r,body:JSON.stringify(t)})).json();if(n.code!==200){const o=n.msg;if(o){if(n.code===1||n.code===10||n.code===18||n.code===110){chrome.runtime.sendMessage({action:o}),stop=!0;return}if(n.code===17||n.code===19||n.code===429){chrome.runtime.sendMessage({action:o}),stop=!0;return}if([4,3,12,13,14,115].includes(n.code))return document.querySelector(".geetest_refresh").click(),null}}return n}catch(s){throw console.error("Error fetching coordinates:",s),s}}async function Ge(e){try{const t=await fetch("https://feedback.captchasonic.com/extFeedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const r=await t.json();return console.log("Success:",r),r}catch(t){return console.error("Error sending feedback:",t),null}}function ze(e,t){const r=document.querySelector(e);if(!r){console.warn(`Element not found: ${e}`);return}return new MutationObserver(n=>{n.forEach(o=>{if(o.attributeName==="aria-hidden"){const c=r.getAttribute("aria-hidden")==="true";window.postMessage({type:"ariaHiddenChange",value:c},"*"),typeof t=="function"&&t(c)}})}).observe(r,{attributes:!0,attributeFilter:["aria-hidden"]}),r.getAttribute("aria-hidden")==="true"}function Je(e,t){const r=`${e}_feedback`;chrome.storage.local.get(`${e}_solved`,s=>{s[`${e}_solved`],chrome.storage.local.get([r],n=>{const o=n[r]||[];if(o.some(f=>f.fail_report===!0)){const f=o.map(h=>h.data),A={type:"feedback",payload:{apiKey:t,data:f,pass:!1}};f.length>0&&chrome.runtime.sendMessage(A,h=>{chrome.storage.local.remove([r,`${e}_solved`,`${e}_feedback`,`${e}_hasRun`],()=>{})})}chrome.storage.local.remove([r,`${e}_solved`],()=>{})})})}function Ze(e,t){const r=`${e}_feedback`;chrome.storage.local.get(`${e}_solved`,s=>{s[`${e}_solved`],chrome.storage.local.get([r],n=>{const o=n[r]||[];if(o.some(f=>f.pass_report===!0)){const f=o.map(h=>h.data),A={type:"feedback",payload:{apiKey:t,data:f,pass:!0}};f.length>0&&chrome.runtime.sendMessage(A,h=>{chrome.storage.local.remove([r,`${e}_solved`,`${e}_feedback`],()=>{})})}chrome.storage.local.remove([r,`${e}_solved`],()=>{})})})}async function Qe(e,t=50,r=.1){return new Promise((s,n)=>{const o=atob(e),c=new Array(o.length);for(let p=0;p<o.length;p++)c[p]=o.charCodeAt(p);const f=new Uint8Array(c),C=new Blob([f],{type:"image/jpeg"}),A=URL.createObjectURL(C),h=new Image;h.onload=()=>{URL.revokeObjectURL(A);const p=document.createElement("canvas");p.width=h.width,p.height=h.height,p.getContext("2d").drawImage(h,0,0);let x=.9,v,l;do v=p.toDataURL("image/jpeg",x),l=v.length*3/4/1024,x-=.05;while(l>t&&x>=r);l>t?n(new Error(`Couldn't compress below ${t}KB. Final size: ${l.toFixed(2)}KB`)):s(v.split(",")[1])},h.onerror=()=>{URL.revokeObjectURL(A),n(new Error("Image load failed (possibly corrupt base64)"))},h.src=A})}async function et(e){return e.replace(/^data:image\/\w+;base64,/,"")}async function tt(e){return new Promise(t=>{chrome.runtime.sendMessage({type:"GET_IMAGE_BASE64",payload:{url:e}},r=>{r?.success?t(r.data):t(null)})})}function rt(){return new Promise((e,t)=>{chrome.runtime.sendMessage({action:"getActiveTabUrl"},r=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(r.url)})})}const _={version:Te,$:L,$$:me,isMulti:de,isGrid:fe,isBbox:he,isBboxDD:Me,isWidget:Ie,sleep:N,randTimer:Re,isSolved:Oe,countdownNotif:Pe,getBase64FromUrl:Ae,refreshIframes:qe,getEn:$e,skip:Le,getBrowser:Ne,shuffle:Be,fireMouseEvents:Q,getCanvas:Ke,handleCanvasDD:Ue,getApi:je,clickMatchingElement:De,sliceOG:Ye,updateExamples:We,getExamples:Xe,solveGeetestCaptcha:Ve,sendCoordinatesRequest:He,geeFetchImage:Fe,sendFeedback:Ge,observeAriaHidden:ze,handleCaptchaFeedback:Je,handleCaptchaFeedbackOnSuccess:Ze,compressPureBase64Image:Qe,stripBase64Prefix:et,fetchBase64Image:tt,getActiveTabUrl:rt},st={matches:["<all_urls>"],allFrames:!0,async main(){let e;try{e=window.top.document.location.href}catch{e=window.location.href}const[t]=oe(e),[r,s]=oe(await chrome.storage.local.get("settings"));s(r().settings);let n=!1,o=0,c=null,f=null;if(window._prosopo)return;window._prosopo=!0;const C=()=>!navigator.onLine||r().APIKEY===void 0||r().APIKEY===""||r().ACTIVE===!1;for(;r()?.OPTIONS.PROSOPO.ENABLED&&!r().BLACKLIST.includes(t)&&!C();){await _.sleep(2e3);const l=document.querySelector("prosopo-procaptcha");if(l&&l.shadowRoot){const b=l.shadowRoot.querySelector("input[type='checkbox']"),y=document.querySelector("img"),m=document.querySelector(".prosopo-modalOuter");let w=!1;if(m&&(w=getComputedStyle(m).display==="flex"),!w&&b&&r()?.OPTIONS.PROSOPO.AUTOOPEN===!0){p(b);const T=document.createElement("script");T.src=chrome.runtime.getURL("themes/proso.js"),(document.head||document.documentElement).appendChild(T)}n===!1&&w&&y&&r()?.OPTIONS.PROSOPO.AUTOSOLVE===!0&&(c=document.querySelector("button[aria-label='Next']"),f=document.querySelector("button[aria-label='Submit']"),document.querySelector("button[aria-label='Reload']"),await h())}}async function A(){const l=document.querySelectorAll("img"),E=Array.from(l).map(y=>y.src);return await Promise.all(E.map(async y=>{try{return await _.getBase64FromUrl(y)}catch{return null}}))}async function h(){n=!0;const l=document.querySelector("p").querySelector("span").textContent.trim(),E=await A(),b={type:"networkRequest",payload:{url:"https://api.captchasonic.com/createTask",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:r().APIKEY,task:{type:"prosopoClassification",websiteURL:t(),queries:E,question:l}})}};chrome.runtime.sendMessage(b,async y=>{if(y.success){const m=y.data;if(m.code!==200){const w=m.msg;w&&((m.code===1||m.code===10||m.code===18||m.code===110)&&(chrome.runtime.sendMessage({action:w}),n=!0),(m.code===17||m.code===19||m.code===429)&&(chrome.runtime.sendMessage({action:w}),n=!0),[4,3,12,13,14,115].includes(m.code)&&(document.querySelector("button[aria-label='Reload']")?.click(),o=0,await v("prosopoCaptcha"),n=!1))}else if(m.code===200&&(m.meta&&function(T,a){const i=`${T}_feedback`;chrome.storage.local.get([i],g=>{const d=g[i]||[];d.push(a),chrome.storage.local.set({[i]:d})})}("prosopoCaptcha",m.meta),m?.answers?.length>0&&await I(m.answers),c&&(c.click(),n=!1),f)){f.click();const w=document.querySelector("prosopo-procaptcha");try{await x(w)?(await _.sleep(1e3),n=!0,_.handleCaptchaFeedbackOnSuccess("prosopoCaptcha",r().APIKEY)):(_.handleCaptchaFeedback("prosopoCaptcha",r().APIKEY),await _.sleep(5e3)),await v("prosopoCaptcha"),o=0}catch(T){console.error("Error waiting for captcha appearance:",T)}finally{n=!1}}}else console.error("Error for Request 2:",y.error)})}function p(l){if(!l)return;if(getComputedStyle(l).appearance!=="auto"){const b=l.getBoundingClientRect(),y=b.left+b.width*(.4+Math.random()*.2),m=b.top+b.height*(.4+Math.random()*.2),w={bubbles:!0,cancelable:!0,view:window,clientX:y,clientY:m};setTimeout(()=>{l.dispatchEvent(new PointerEvent("pointerdown",w)),l.dispatchEvent(new PointerEvent("pointerup",w)),l.dispatchEvent(new MouseEvent("click",w))},200+Math.random()*300)}}async function I(l){const E=document.querySelectorAll("img");for(const b of E){const y=b.alt.match(/\d+/);if(y){const m=parseInt(y[0],10)-1;l[m]&&(b.click(),await _.sleep(1e3))}}}async function x(l,E=100,b=5e3){return new Promise((y,m)=>{if(!l||!l.shadowRoot)return m(new Error("Invalid captcha element or missing shadow root."));const w=l.shadowRoot.querySelector("input[type='checkbox']");if(!w)return m(new Error("Checkbox not found inside shadow root."));const T=Date.now(),a=()=>{try{if(getComputedStyle(w).appearance==="auto")return y(!0);if(Date.now()-T>=b)return y(!1);setTimeout(a,E)}catch(i){m(i)}};a()})}async function v(l){const E=`${l}_feedback`;chrome.storage.local.remove(E,()=>{})}}};function nt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var H={exports:{}},ot=H.exports,pe;function at(){return pe||(pe=1,function(e,t){(function(r,s){s(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:ot,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const s="The message port closed before a response was received.",n=o=>{const c={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(c).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class f extends WeakMap{constructor(i,g=void 0){super(g),this.createItem=i}get(i){return this.has(i)||this.set(i,this.createItem(i)),super.get(i)}}const C=a=>a&&typeof a=="object"&&typeof a.then=="function",A=(a,i)=>(...g)=>{o.runtime.lastError?a.reject(new Error(o.runtime.lastError.message)):i.singleCallbackArg||g.length<=1&&i.singleCallbackArg!==!1?a.resolve(g[0]):a.resolve(g)},h=a=>a==1?"argument":"arguments",p=(a,i)=>function(d,...P){if(P.length<i.minArgs)throw new Error(`Expected at least ${i.minArgs} ${h(i.minArgs)} for ${a}(), got ${P.length}`);if(P.length>i.maxArgs)throw new Error(`Expected at most ${i.maxArgs} ${h(i.maxArgs)} for ${a}(), got ${P.length}`);return new Promise((R,O)=>{if(i.fallbackToNoCallback)try{d[a](...P,A({resolve:R,reject:O},i))}catch(u){console.warn(`${a} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,u),d[a](...P),i.fallbackToNoCallback=!1,i.noCallback=!0,R()}else i.noCallback?(d[a](...P),R()):d[a](...P,A({resolve:R,reject:O},i))})},I=(a,i,g)=>new Proxy(i,{apply(d,P,R){return g.call(P,a,...R)}});let x=Function.call.bind(Object.prototype.hasOwnProperty);const v=(a,i={},g={})=>{let d=Object.create(null),P={has(O,u){return u in a||u in d},get(O,u,F){if(u in d)return d[u];if(!(u in a))return;let S=a[u];if(typeof S=="function")if(typeof i[u]=="function")S=I(a,a[u],i[u]);else if(x(g,u)){let B=p(u,g[u]);S=I(a,a[u],B)}else S=S.bind(a);else if(typeof S=="object"&&S!==null&&(x(i,u)||x(g,u)))S=v(S,i[u],g[u]);else if(x(g,"*"))S=v(S,i[u],g["*"]);else return Object.defineProperty(d,u,{configurable:!0,enumerable:!0,get(){return a[u]},set(B){a[u]=B}}),S;return d[u]=S,S},set(O,u,F,S){return u in d?d[u]=F:a[u]=F,!0},defineProperty(O,u,F){return Reflect.defineProperty(d,u,F)},deleteProperty(O,u){return Reflect.deleteProperty(d,u)}},R=Object.create(a);return new Proxy(R,P)},l=a=>({addListener(i,g,...d){i.addListener(a.get(g),...d)},hasListener(i,g){return i.hasListener(a.get(g))},removeListener(i,g){i.removeListener(a.get(g))}}),E=new f(a=>typeof a!="function"?a:function(g){const d=v(g,{},{getContent:{minArgs:0,maxArgs:0}});a(d)}),b=new f(a=>typeof a!="function"?a:function(g,d,P){let R=!1,O,u=new Promise(K=>{O=function(q){R=!0,K(q)}}),F;try{F=a(g,d,O)}catch(K){F=Promise.reject(K)}const S=F!==!0&&C(F);if(F!==!0&&!S&&!R)return!1;const B=K=>{K.then(q=>{P(q)},q=>{let se;q&&(q instanceof Error||typeof q.message=="string")?se=q.message:se="An unexpected error occurred",P({__mozWebExtensionPolyfillReject__:!0,message:se})}).catch(q=>{console.error("Failed to send onMessage rejected reply",q)})};return B(S?F:u),!0}),y=({reject:a,resolve:i},g)=>{o.runtime.lastError?o.runtime.lastError.message===s?i():a(new Error(o.runtime.lastError.message)):g&&g.__mozWebExtensionPolyfillReject__?a(new Error(g.message)):i(g)},m=(a,i,g,...d)=>{if(d.length<i.minArgs)throw new Error(`Expected at least ${i.minArgs} ${h(i.minArgs)} for ${a}(), got ${d.length}`);if(d.length>i.maxArgs)throw new Error(`Expected at most ${i.maxArgs} ${h(i.maxArgs)} for ${a}(), got ${d.length}`);return new Promise((P,R)=>{const O=y.bind(null,{resolve:P,reject:R});d.push(O),g.sendMessage(...d)})},w={devtools:{network:{onRequestFinished:l(E)}},runtime:{onMessage:l(b),onMessageExternal:l(b),sendMessage:m.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:m.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},T={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return c.privacy={network:{"*":T},services:{"*":T},websites:{"*":T}},v(o,w,c)};r.exports=n(chrome)}})}(H)),H.exports}var it=at();const be=nt(it);function G(e,...t){}const ct={debug:(...e)=>G(console.debug,...e),log:(...e)=>G(console.log,...e),warn:(...e)=>G(console.warn,...e),error:(...e)=>G(console.error,...e)};class te extends Event{constructor(t,r){super(te.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=r}static EVENT_NAME=re("wxt:locationchange")}function re(e){return`${be?.runtime?.id}:prosopo:${e}`}function lt(e){let t,r;return{run(){t==null&&(r=new URL(location.href),t=e.setInterval(()=>{let s=new URL(location.href);s.href!==r.href&&(window.dispatchEvent(new te(s,r)),r=s)},1e3))}}}class z{constructor(t,r){this.contentScriptName=t,this.options=r,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=re("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=lt(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return be.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,r){const s=setInterval(()=>{this.isValid&&t()},r);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(t,r){const s=setTimeout(()=>{this.isValid&&t()},r);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(t){const r=requestAnimationFrame((...s)=>{this.isValid&&t(...s)});return this.onInvalidated(()=>cancelAnimationFrame(r)),r}requestIdleCallback(t,r){const s=requestIdleCallback((...n)=>{this.signal.aborted||t(...n)},r);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(t,r,s,n){r==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(r.startsWith("wxt:")?re(r):r,s,{...n,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),ct.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:z.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){const r=t.data?.type===z.SCRIPT_STARTED_MESSAGE_TYPE,s=t.data?.contentScriptName===this.contentScriptName,n=!this.receivedMessageIds.has(t.data?.messageId);return r&&s&&n}listenForNewerScripts(t){let r=!0;const s=n=>{if(this.verifyScriptStartedEvent(n)){this.receivedMessageIds.add(n.data.messageId);const o=r;if(r=!1,o&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}}const ut=Symbol("null");let gt=0;class mt extends Map{constructor(){super(),this._objectHashes=new WeakMap,this._symbolHashes=new Map,this._publicKeys=new Map;const[t]=arguments;if(t!=null){if(typeof t[Symbol.iterator]!="function")throw new TypeError(typeof t+" is not iterable (cannot read property Symbol(Symbol.iterator))");for(const[r,s]of t)this.set(r,s)}}_getPublicKeys(t,r=!1){if(!Array.isArray(t))throw new TypeError("The keys parameter must be an array");const s=this._getPrivateKey(t,r);let n;return s&&this._publicKeys.has(s)?n=this._publicKeys.get(s):r&&(n=[...t],this._publicKeys.set(s,n)),{privateKey:s,publicKey:n}}_getPrivateKey(t,r=!1){const s=[];for(let n of t){n===null&&(n=ut);const o=typeof n=="object"||typeof n=="function"?"_objectHashes":typeof n=="symbol"?"_symbolHashes":!1;if(!o)s.push(n);else if(this[o].has(n))s.push(this[o].get(n));else if(r){const c=`@@mkm-ref-${gt++}@@`;this[o].set(n,c),s.push(c)}else return!1}return JSON.stringify(s)}set(t,r){const{publicKey:s}=this._getPublicKeys(t,!0);return super.set(s,r)}get(t){const{publicKey:r}=this._getPublicKeys(t);return super.get(r)}has(t){const{publicKey:r}=this._getPublicKeys(t);return super.has(r)}delete(t){const{publicKey:r,privateKey:s}=this._getPublicKeys(t);return!!(r&&super.delete(r)&&this._publicKeys.delete(s))}clear(){super.clear(),this._symbolHashes.clear(),this._publicKeys.clear()}get[Symbol.toStringTag](){return"ManyKeysMap"}get size(){return super.size}}new mt;function pt(){}function J(e,...t){}const dt={debug:(...e)=>J(console.debug,...e),log:(...e)=>J(console.log,...e),warn:(...e)=>J(console.warn,...e),error:(...e)=>J(console.error,...e)};return(async()=>{try{const{main:e,...t}=st,r=new z("prosopo",t);return await e(r)}catch(e){throw dt.error('The content script "prosopo" crashed on startup!',e),e}})()}();
prosopo;
