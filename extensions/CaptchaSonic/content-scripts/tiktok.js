var tiktok=function(){"use strict";function xt(e){return e}const ke=!1,ce={equals:(e,t)=>e===t};let Ee=me;const D=1,j=2;var X=null;let te=null,Se=null,I=null,M=null,U=null,Y=0;function re(e,t){t=t?Object.assign({},ce,t):ce;const r={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=n=>(typeof n=="function"&&(n=n(r.value)),le(r,n));return[Te.bind(r),s]}function Ce(e){if(I===null)return e();const t=I;I=null;try{return e()}finally{I=t}}function Te(){if(this.sources&&this.state)if(this.state===D)ue(this);else{const e=M;M=null,W(()=>H(this)),M=e}if(I){const e=this.observers?this.observers.length:0;I.sources?(I.sources.push(this),I.sourceSlots.push(e)):(I.sources=[this],I.sourceSlots=[e]),this.observers?(this.observers.push(I),this.observerSlots.push(I.sources.length-1)):(this.observers=[I],this.observerSlots=[I.sources.length-1])}return this.value}function le(e,t,r){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&W(()=>{for(let n=0;n<e.observers.length;n+=1){const i=e.observers[n],g=te&&te.running;g&&te.disposed.has(i),(g?!i.tState:!i.state)&&(i.pure?M.push(i):U.push(i),i.observers&&de(i)),g||(i.state=D)}if(M.length>1e6)throw M=[],new Error})),t}function ue(e){if(!e.fn)return;V(e);const t=Y;Pe(e,e.value,t)}function Pe(e,t,r){let s;const n=X,i=I;I=X=e;try{s=e.fn(t)}catch(g){return e.pure&&(e.state=D,e.owned&&e.owned.forEach(V),e.owned=null),e.updatedAt=r+1,fe(g)}finally{I=i,X=n}(!e.updatedAt||e.updatedAt<=r)&&(e.updatedAt!=null&&"observers"in e?le(e,s):e.value=s,e.updatedAt=r)}function ge(e){if(e.state===0)return;if(e.state===j)return H(e);if(e.suspense&&Ce(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Y);)e.state&&t.push(e);for(let r=t.length-1;r>=0;r--)if(e=t[r],e.state===D)ue(e);else if(e.state===j){const s=M;M=null,W(()=>H(e,t[0])),M=s}}function W(e,t){if(M)return e();let r=!1;M=[],U?r=!0:U=[],Y++;try{const s=e();return Ie(r),s}catch(s){r||(U=null),M=null,fe(s)}}function Ie(e){if(M&&(me(M),M=null),e)return;const t=U;U=null,t.length&&W(()=>Ee(t))}function me(e){for(let t=0;t<e.length;t++)ge(e[t])}function H(e,t){e.state=0;for(let r=0;r<e.sources.length;r+=1){const s=e.sources[r];if(s.sources){const n=s.state;n===D?s!==t&&(!s.updatedAt||s.updatedAt<Y)&&ge(s):n===j&&H(s,t)}}}function de(e){for(let t=0;t<e.observers.length;t+=1){const r=e.observers[t];r.state||(r.state=j,r.pure?M.push(r):U.push(r),r.observers&&de(r))}}function V(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),s=e.sourceSlots.pop(),n=r.observers;if(n&&n.length){const i=n.pop(),g=r.observerSlots.pop();s<n.length&&(i.sourceSlots[g]=s,n[s]=i,r.observerSlots[s]=g)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)V(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)V(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Me(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function fe(e,t=X){throw Me(e)}const qe="0.2.1",Oe=(e,t)=>{const r=document.createElement("div");r.style.cssText="position:fixed;top:8%;left:0;background-color:rgba(0,0,0,.6);padding:2px;color:#fff;font:calc(14px + .5vw) 'Arial',sans-serif;font-weight:bold;text-transform:uppercase;letter-spacing:1px;z-index:9999;transition:all 1s;animation:slideIn 1s forwards",r.innerHTML=`<p>${e}. Retrying in..<span id="countdown">${t}</span></p>`,document.body.appendChild(r),(()=>{const i=document.getElementById("countdown");if(!i)return;let g=t;const d=setInterval(()=>{g--,i.textContent=g,g<=0&&clearInterval(d)},1e3)})();const n=document.createElement("style");n.innerHTML="@keyframes slideIn{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}@keyframes slideOut{0%{transform:translateX(0)}100%{transform:translateX(100%)}}",document.head.appendChild(n),setTimeout(()=>{r.style.animation="slideOut 1s forwards",setTimeout(()=>{document.body.removeChild(r)},1e3)},t*1e3)},N=e=>document.querySelector(e),he=e=>document.querySelectorAll(e);function Ae(){return N(".task-answers")!==null}function pe(){return he(".task-image .image").length===9}function be(){return N(".bounding-box-example")!==null}function Fe(){return N(".challenge-header")!==null&&N(".bounding-box-example")===null&&N(".task-grid")==null}function Re(){const e=document.body.getBoundingClientRect();return e?.width===0||e?.height===0?!1:document.querySelector("div.check")!==null}function K(e){return new Promise(t=>setTimeout(t,e))}function _e(e,t){return Math.floor(Math.random()*(t-e)+e)}function Be(){try{const e=document.querySelector("div.check");return e&&e.style.display==="block"}catch(e){return console.error(e),!1}}async function $e(e){const t=await(await fetch(e,{headers:{"if-none-match":'"CFDAD5AA0CE4A3068FF1CABAC59E4D9D"'},host:"https://domain.com"})).blob();return await Ue(t)}async function Ue(e){return new Promise(t=>{const r=new FileReader;r.readAsDataURL(e),r.addEventListener("loadend",()=>{const s=r.result.replace(/^data:image\/(png|jpeg);base64,/,"");t(s)}),r.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}async function we(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch the URL: ${e}`);const r=await t.blob();return new Promise((s,n)=>{const i=new FileReader;i.readAsDataURL(r),i.addEventListener("loadend",()=>{s(i.result.replace(/^data:image\/(png|jpeg);base64,/,""))}),i.addEventListener("error",()=>{console.error("❌ Failed to read blob as base64"),n("Failed to read blob")})})}catch(t){return console.error(`❌ Failed to convert URL to base64: ${e}`,t),null}}function Le(){document.querySelectorAll("iframe").forEach(t=>{t.src=t.src})}async function Ne(){be()?(await K(200),document.querySelector(".display-language.button").click(),await K(100),document.querySelector(".language-selector .option:nth-child(23)").click()):pe()?(await K(100),document.querySelector(".language-selector .option:nth-child(23)").click()):Ae()&&(document.querySelector(".display-language.button").click(),await K(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await K(200))}function Ke(){document.querySelector(".button-submit").click()}async function De(){const e=navigator.userAgent;let t,r=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],`IE ${t[1]||""}`):r[1]==="Chrome"&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=e.match(/version\/(\d+)/i))!=null&&r.splice(1,1,t[1]),{version:r,platform:navigator.platform})}function je(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}function se(e){["mouseover","mousedown","mouseup","click"].forEach(t=>{if(e.fireEvent)e.fireEvent("on"+t);else{const r=document.createEvent("MouseEvents");r.initEvent(t,!0,!1),e.dispatchEvent(r)}})}function ne(e,t,r,s,n,i,g){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,clientX:r,clientY:s,buttons:n,button:i,pressure:g}))}async function Xe(e,t){const r=document.querySelector("canvas");if(e!==void 0)for(const{start:s,end:n}of e)if(Array.isArray(s)&&s.length!==0&&Array.isArray(n)&&n.length!==0){const[i,g]=s,[d,S]=n,w=r.getBoundingClientRect(),f=i+w.left,b=g+w.top,O=d+w.left,E=S+w.top;ne(r,"mousedown",f,b,1,0,1),await new Promise(x=>setTimeout(x,t));const P=O-f,k=E-b,B=Math.sqrt(P**2+k**2),F=Math.round(B/6),h=P/F,y=k/F;for(let x=1;x<=F;x++){const C=f+h*x,o=b+y*x;ne(r,"mousemove",C,o,1,0,1),await new Promise(a=>setTimeout(a,50))}ne(r,"mouseup",O,E,0,0,0)}else q.$(".button-submit").click();else q.$(".button-submit").click()}async function Ye(e){function t(i,g,d){const S=i.getBoundingClientRect(),w=["mouseover","mousedown","mouseup","click"],f={clientX:g+S.left,clientY:d+S.top,bubbles:!0};for(let b=0;b<w.length;b++){const O=new MouseEvent(w[b],f);i.dispatchEvent(O)}}const r=document.querySelector("canvas");r.addEventListener("mousedown",i=>{const g=r.getBoundingClientRect();i.clientX-g.left,i.clientY-g.top});const[s,n]=e;t(r,s,n),await q.sleep(300)}async function We(e,t){const r=(await chrome.storage.local.get("customEndpoint")).customEndpoint;return t==="custom"?`https://${r}/${e}`:"https://api.captchasonic.com/createTask"}async function He(e){for(const t of e){const r=[...document.querySelectorAll(".answer-text")].find(s=>s.outerText===t);se(r),[...document.querySelectorAll(".answer-example")].some(s=>s.style.backgroundColor==="rgb(116, 116, 116)")||se(r)}}async function Ve(){const e=document.querySelector("canvas");if(!e)return null;const[t,r]=[e.width,e.height],n=e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,t,r,{willReadFrequently:!0});if((E=>{const P=E.data;for(let k=0;k<P.length;k+=4){const B=P[k],F=P[k+1],h=P[k+2];if(B!==F||F!==h)return!1}return!0})(n))return null;const g=parseInt(e.style.width,10),d=parseInt(e.style.height,10);if(g<=0||d<=0)return null;const S=Math.min(g/t,d/r),[w,f]=[t*S,r*S],b=document.createElement("canvas");return Object.assign(b,{width:w,height:f}),b.getContext("2d",{willReadFrequently:!0}).drawImage(e,0,0,t,r,0,0,w,f),b.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/,"")}function ze(e){return[...document.querySelectorAll(`${e}`)].map(t=>t.style.backgroundImage.replace(/url\("|"\)/g,""))}function Ge(e){return Promise.all(e.map(async(t,r)=>(e[r]=await we(t),e[r])))}async function Je(e,t,r){const s=e.getBoundingClientRect(),n=s.left+window.scrollX,i=s.top+window.scrollY,g=n+t,d=i+r,S=new MouseEvent("mousedown",{clientX:n,clientY:i,bubbles:!0});e.dispatchEvent(S),await new Promise(E=>setTimeout(E,1e3));const w=20,f=(g-n)/w,b=(d-i)/w;for(let E=1;E<=w;E++){const P=n+f*E,k=i+b*E,B=new MouseEvent("mousemove",{clientX:P,clientY:k,bubbles:!0});e.dispatchEvent(B),await new Promise(F=>setTimeout(F,150))}const O=new MouseEvent("mouseup",{clientX:g,clientY:d,bubbles:!0});e.dispatchEvent(O),await new Promise(E=>setTimeout(E,1e3))}async function Ze(e,t,r){try{const n=await(await fetch(e,{method:"POST",headers:r,body:JSON.stringify(t)})).json();if(n.code!==200){const i=n.msg;if(i){if(n.code===1||n.code===10||n.code===18||n.code===110){chrome.runtime.sendMessage({action:i}),stop=!0;return}if(n.code===17||n.code===19||n.code===429){chrome.runtime.sendMessage({action:i}),stop=!0;return}if([4,3,12,13,14,115].includes(n.code))return document.querySelector(".geetest_refresh").click(),null}}return n}catch(s){throw console.error("Error fetching coordinates:",s),s}}async function Qe(e){try{const t=await fetch("https://feedback.captchasonic.com/extFeedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const r=await t.json();return console.log("Success:",r),r}catch(t){return console.error("Error sending feedback:",t),null}}function et(e,t){const r=document.querySelector(e);if(!r){console.warn(`Element not found: ${e}`);return}return new MutationObserver(n=>{n.forEach(i=>{if(i.attributeName==="aria-hidden"){const g=r.getAttribute("aria-hidden")==="true";window.postMessage({type:"ariaHiddenChange",value:g},"*"),typeof t=="function"&&t(g)}})}).observe(r,{attributes:!0,attributeFilter:["aria-hidden"]}),r.getAttribute("aria-hidden")==="true"}function tt(e,t){const r=`${e}_feedback`;chrome.storage.local.get(`${e}_solved`,s=>{s[`${e}_solved`],chrome.storage.local.get([r],n=>{const i=n[r]||[];if(i.some(d=>d.fail_report===!0)){const d=i.map(f=>f.data),w={type:"feedback",payload:{apiKey:t,data:d,pass:!1}};d.length>0&&chrome.runtime.sendMessage(w,f=>{chrome.storage.local.remove([r,`${e}_solved`,`${e}_feedback`,`${e}_hasRun`],()=>{})})}chrome.storage.local.remove([r,`${e}_solved`],()=>{})})})}function rt(e,t){const r=`${e}_feedback`;chrome.storage.local.get(`${e}_solved`,s=>{s[`${e}_solved`],chrome.storage.local.get([r],n=>{const i=n[r]||[];if(i.some(d=>d.pass_report===!0)){const d=i.map(f=>f.data),w={type:"feedback",payload:{apiKey:t,data:d,pass:!0}};d.length>0&&chrome.runtime.sendMessage(w,f=>{chrome.storage.local.remove([r,`${e}_solved`,`${e}_feedback`],()=>{})})}chrome.storage.local.remove([r,`${e}_solved`],()=>{})})})}async function st(e,t=50,r=.1){return new Promise((s,n)=>{const i=atob(e),g=new Array(i.length);for(let b=0;b<i.length;b++)g[b]=i.charCodeAt(b);const d=new Uint8Array(g),S=new Blob([d],{type:"image/jpeg"}),w=URL.createObjectURL(S),f=new Image;f.onload=()=>{URL.revokeObjectURL(w);const b=document.createElement("canvas");b.width=f.width,b.height=f.height,b.getContext("2d").drawImage(f,0,0);let E=.9,P,k;do P=b.toDataURL("image/jpeg",E),k=P.length*3/4/1024,E-=.05;while(k>t&&E>=r);k>t?n(new Error(`Couldn't compress below ${t}KB. Final size: ${k.toFixed(2)}KB`)):s(P.split(",")[1])},f.onerror=()=>{URL.revokeObjectURL(w),n(new Error("Image load failed (possibly corrupt base64)"))},f.src=w})}async function nt(e){return e.replace(/^data:image\/\w+;base64,/,"")}async function ot(e){return new Promise(t=>{chrome.runtime.sendMessage({type:"GET_IMAGE_BASE64",payload:{url:e}},r=>{r?.success?t(r.data):t(null)})})}function at(){return new Promise((e,t)=>{chrome.runtime.sendMessage({action:"getActiveTabUrl"},r=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(r.url)})})}const q={version:qe,$:N,$$:he,isMulti:Ae,isGrid:pe,isBbox:be,isBboxDD:Fe,isWidget:Re,sleep:K,randTimer:_e,isSolved:Be,countdownNotif:Oe,getBase64FromUrl:we,refreshIframes:Le,getEn:Ne,skip:Ke,getBrowser:De,shuffle:je,fireMouseEvents:se,getCanvas:Ye,handleCanvasDD:Xe,getApi:We,clickMatchingElement:He,sliceOG:Ve,updateExamples:Ge,getExamples:ze,solveGeetestCaptcha:Je,sendCoordinatesRequest:Ze,geeFetchImage:$e,sendFeedback:Qe,observeAriaHidden:et,handleCaptchaFeedback:tt,handleCaptchaFeedbackOnSuccess:rt,compressPureBase64Image:st,stripBase64Prefix:nt,fetchBase64Image:ot,getActiveTabUrl:at},it={matches:["<all_urls>"],allFrames:!0,async main(){let e;try{e=window.top.document.location.href}catch{e=window.location.href}const[t]=re(e),[r,s]=re(await chrome.storage.local.get("settings"));s(r().settings);const[n,i]=re(null),g=()=>!navigator.onLine||r().APIKEY===void 0||r().APIKEY===""||r().ACTIVE===!1;let d=!1,S="";new MutationObserver(h=>{for(const y of h)for(const x of y.addedNodes){if(x.nodeType!==1)continue;if(x.querySelector('svg path[fill="#0BE09B"]')){x.querySelector("span")?.textContent?.trim(),q.handleCaptchaFeedbackOnSuccess(n(),r().APIKEY);continue}if(x.querySelector('svg path[fill="#FF4C3A"]')){x.querySelector("span")?.textContent?.trim(),q.handleCaptchaFeedback(n(),r().APIKEY);continue}}}).observe(document.body,{childList:!0,subtree:!0});let f=0;async function b(h){return new Promise((y,x)=>{try{const C={type:"networkRequest",payload:{url:"https://api.captchasonic.com/createTask",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}};chrome.runtime.sendMessage(C,async o=>{if(o.success){const a=o.data;if(a.code!==200){const c=a.msg;if(c){if(a.code===1||a.code===10||a.code===18||o.code===110){chrome.runtime.sendMessage({action:c}),d=!0;return}if(a.code===17||a.code===19||a.code===429){chrome.runtime.sendMessage({action:c}),d=!0;return}if([4,3,12,13,14,115].includes(a.code))return await k(),y(null)}}else if(a.code===200){if(a.meta){let l=function(m,A){const p=`${m}_feedback`;chrome.storage.local.get([p],u=>{const v=u[p]||[];v.push(A),chrome.storage.local.set({[p]:v})})},c=Math.random().toString(36).substring(7);i(c),l(c,a.meta)}return y(a)}}else console.error("Error for Request 2:",o.error)})}catch(C){return console.error("Error fetching coordinates:",C),x(C)}})}async function O({captchaType:h,captchaContainer:y,currentUrl:x,apiKey:C}){const o={apiKey:C,source:"chrome",version:q.version,appID:0,task:{type:"tiktokClassification",queries:[],examples:[],question:"",websiteURL:x}},a=document.querySelector("span.cap-flex.cap-items-center")?.textContent?.trim();if(h==="tiktokCircle"){const c=y?.querySelectorAll("img"),l=c?.[0]?.src,m=c?.[1]?.src;if(l){const A=await q.getBase64FromUrl(l),p=await q.stripBase64Prefix(A);o.task.queries.push(p)}if(m){const A=await q.getBase64FromUrl(m),p=await q.stripBase64Prefix(A);o.task.examples.push(p)}o.task.question=`tiktok_whirl:${a}`}if(h==="tiktokClick"){const l=y?.querySelector("img")?.src;if(l){const m=await q.getBase64FromUrl(l),A=await q.stripBase64Prefix(m);o.task.queries.push(A),o.task.question=`tiktok_click:${a}`}}return o}async function E(h,y,x){if(!h){console.error("Image element not found");return}const C=h.getBoundingClientRect(),o=C.width,a=C.height,[c,l]=x;y.forEach(async([m,A])=>{const p=o/l*m,u=a/c*A,v=C.left+Math.round(p),T=C.top+Math.round(u),R=new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:v,clientY:T,view:window});h.dispatchEvent(R),await q.sleep(3e3)})}let P=null;for(;!g();){await q.sleep(2e3);const h=document.querySelector(".TUXModal.captcha-verify-container");if(!h)continue;let y=h?await B():null;const x=h?.querySelectorAll("img"),C=x?.length;if(C===2&&y==="slide"?S="tiktokCircle":C===1&&y==="click"&&(S="tiktokClick"),S==="tiktokCircle"||S==="tiktokClick"){const{hash:o,shouldReload:a}=await F(x);if(!o)continue;if(P===o&&r().OPTIONS.TIKTOK.AUTOSOLVE===!0){f++,f>3&&(await k(),f=0);continue}P=o;const c=await O({captchaType:S,captchaContainer:h,currentUrl:t(),apiKey:r().APIKEY});if(S==="tiktokCircle"&&r().OPTIONS.TIKTOK.AUTOSOLVE===!0){let l=null;if(c.task.queries.length>0&&c.task.examples.length>0&&(l=await b(c)),l){const m=u=>{const R=180/(window.innerWidth<640?224:284);return Math.round(u/R)};async function A(u){if(d)return;d=!0;const v=document.querySelector("div.cap-flex.cap-absolute");if(!v){console.error("Slider element not found"),d=!1;return}const T=v.getBoundingClientRect(),R=0,$=T.top-10,_=m(u);v.dispatchEvent(new MouseEvent("mousedown",{clientX:R,clientY:$,bubbles:!0,cancelable:!0}));let L=0;const ve=100;let ie=0;const bt=setInterval(()=>{ie++;const wt=ie/ve,yt=Math.pow(wt,.4);L=Math.round(_*yt);const Q=R+L,ee=$;v.dispatchEvent(new MouseEvent("mousemove",{clientX:Q,clientY:ee,bubbles:!0,cancelable:!0})),v.dispatchEvent(new DragEvent("drag",{clientX:Q,clientY:ee,bubbles:!0,cancelable:!0})),(ie>=ve||L>=_)&&(clearInterval(bt),setTimeout(()=>{v.dispatchEvent(new MouseEvent("mouseup",{clientX:Q,clientY:ee,bubbles:!0,cancelable:!0})),v.dispatchEvent(new DragEvent("dragend",{clientX:Q,clientY:ee,bubbles:!0,cancelable:!0})),d=!1},200))},20)}const p=l.answers[0];if(!d&&p&&r().OPTIONS.TIKTOK.AUTOSOLVE===!0)for(const u of l.answers)await A(u)}}if(S==="tiktokClick"){let l=null;if(c.task.queries.length>0&&r().OPTIONS.TIKTOK.AUTOSOLVE===!0&&(l=await b(c)),l&&Array.isArray(l.answers)&&l.answers.length>0&&Array.isArray(l.answers[0])&&l.answers[0].length>0)for(const m of l.answers[0])if(Array.isArray(m.solution)&&m.solution.length>0&&Array.isArray(m.size)&&m.size.length===2){const A=document.querySelector("img");if(A){await E(A,m.solution,m.size),await q.sleep(1e3);const p=document.querySelector(".TUXButton-label");p&&p.click()}else await k()}else await k();else await k()}}}async function k(){let h=document.querySelector("#captcha_refresh_button");h&&h.click()}async function B(){const h=document.querySelector("#captcha_slide_button"),y=document.querySelector(".TUXButton-label");return h?"slide":y?"click":"unknown"}async function F(h){try{const y=h[0]?.src||"";if(!y)return{hash:""};if(y.startsWith("blob:"))try{const c=await fetch(y);if(!c.ok)return{hash:""};const l=await c.arrayBuffer(),m=await crypto.subtle.digest("SHA-256",l);return{hash:Array.from(new Uint8Array(m)).map(p=>p.toString(16).padStart(2,"0")).join(""),shouldReload:!1}}catch{return{hash:""}}if(!isValidUrl(y))return{hash:""};const x=await fetch(y);if(!x.ok)return{hash:""};const C=await x.arrayBuffer(),o=await crypto.subtle.digest("SHA-256",C);return{hash:Array.from(new Uint8Array(o)).map(c=>c.toString(16).padStart(2,"0")).join(""),shouldReload:!1}}catch{return{hash:""}}}}};function ct(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var z={exports:{}},lt=z.exports,ye;function ut(){return ye||(ye=1,function(e,t){(function(r,s){s(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:lt,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const s="The message port closed before a response was received.",n=i=>{const g={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(g).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class d extends WeakMap{constructor(a,c=void 0){super(c),this.createItem=a}get(a){return this.has(a)||this.set(a,this.createItem(a)),super.get(a)}}const S=o=>o&&typeof o=="object"&&typeof o.then=="function",w=(o,a)=>(...c)=>{i.runtime.lastError?o.reject(new Error(i.runtime.lastError.message)):a.singleCallbackArg||c.length<=1&&a.singleCallbackArg!==!1?o.resolve(c[0]):o.resolve(c)},f=o=>o==1?"argument":"arguments",b=(o,a)=>function(l,...m){if(m.length<a.minArgs)throw new Error(`Expected at least ${a.minArgs} ${f(a.minArgs)} for ${o}(), got ${m.length}`);if(m.length>a.maxArgs)throw new Error(`Expected at most ${a.maxArgs} ${f(a.maxArgs)} for ${o}(), got ${m.length}`);return new Promise((A,p)=>{if(a.fallbackToNoCallback)try{l[o](...m,w({resolve:A,reject:p},a))}catch(u){console.warn(`${o} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,u),l[o](...m),a.fallbackToNoCallback=!1,a.noCallback=!0,A()}else a.noCallback?(l[o](...m),A()):l[o](...m,w({resolve:A,reject:p},a))})},O=(o,a,c)=>new Proxy(a,{apply(l,m,A){return c.call(m,o,...A)}});let E=Function.call.bind(Object.prototype.hasOwnProperty);const P=(o,a={},c={})=>{let l=Object.create(null),m={has(p,u){return u in o||u in l},get(p,u,v){if(u in l)return l[u];if(!(u in o))return;let T=o[u];if(typeof T=="function")if(typeof a[u]=="function")T=O(o,o[u],a[u]);else if(E(c,u)){let R=b(u,c[u]);T=O(o,o[u],R)}else T=T.bind(o);else if(typeof T=="object"&&T!==null&&(E(a,u)||E(c,u)))T=P(T,a[u],c[u]);else if(E(c,"*"))T=P(T,a[u],c["*"]);else return Object.defineProperty(l,u,{configurable:!0,enumerable:!0,get(){return o[u]},set(R){o[u]=R}}),T;return l[u]=T,T},set(p,u,v,T){return u in l?l[u]=v:o[u]=v,!0},defineProperty(p,u,v){return Reflect.defineProperty(l,u,v)},deleteProperty(p,u){return Reflect.deleteProperty(l,u)}},A=Object.create(o);return new Proxy(A,m)},k=o=>({addListener(a,c,...l){a.addListener(o.get(c),...l)},hasListener(a,c){return a.hasListener(o.get(c))},removeListener(a,c){a.removeListener(o.get(c))}}),B=new d(o=>typeof o!="function"?o:function(c){const l=P(c,{},{getContent:{minArgs:0,maxArgs:0}});o(l)}),F=new d(o=>typeof o!="function"?o:function(c,l,m){let A=!1,p,u=new Promise($=>{p=function(_){A=!0,$(_)}}),v;try{v=o(c,l,p)}catch($){v=Promise.reject($)}const T=v!==!0&&S(v);if(v!==!0&&!T&&!A)return!1;const R=$=>{$.then(_=>{m(_)},_=>{let L;_&&(_ instanceof Error||typeof _.message=="string")?L=_.message:L="An unexpected error occurred",m({__mozWebExtensionPolyfillReject__:!0,message:L})}).catch(_=>{console.error("Failed to send onMessage rejected reply",_)})};return R(T?v:u),!0}),h=({reject:o,resolve:a},c)=>{i.runtime.lastError?i.runtime.lastError.message===s?a():o(new Error(i.runtime.lastError.message)):c&&c.__mozWebExtensionPolyfillReject__?o(new Error(c.message)):a(c)},y=(o,a,c,...l)=>{if(l.length<a.minArgs)throw new Error(`Expected at least ${a.minArgs} ${f(a.minArgs)} for ${o}(), got ${l.length}`);if(l.length>a.maxArgs)throw new Error(`Expected at most ${a.maxArgs} ${f(a.maxArgs)} for ${o}(), got ${l.length}`);return new Promise((m,A)=>{const p=h.bind(null,{resolve:m,reject:A});l.push(p),c.sendMessage(...l)})},x={devtools:{network:{onRequestFinished:k(B)}},runtime:{onMessage:k(F),onMessageExternal:k(F),sendMessage:y.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:y.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},C={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return g.privacy={network:{"*":C},services:{"*":C},websites:{"*":C}},P(i,x,g)};r.exports=n(chrome)}})}(z)),z.exports}var gt=ut();const xe=ct(gt);function G(e,...t){}const mt={debug:(...e)=>G(console.debug,...e),log:(...e)=>G(console.log,...e),warn:(...e)=>G(console.warn,...e),error:(...e)=>G(console.error,...e)};class oe extends Event{constructor(t,r){super(oe.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=r}static EVENT_NAME=ae("wxt:locationchange")}function ae(e){return`${xe?.runtime?.id}:tiktok:${e}`}function dt(e){let t,r;return{run(){t==null&&(r=new URL(location.href),t=e.setInterval(()=>{let s=new URL(location.href);s.href!==r.href&&(window.dispatchEvent(new oe(s,r)),r=s)},1e3))}}}class J{constructor(t,r){this.contentScriptName=t,this.options=r,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=ae("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=dt(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return xe.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,r){const s=setInterval(()=>{this.isValid&&t()},r);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(t,r){const s=setTimeout(()=>{this.isValid&&t()},r);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(t){const r=requestAnimationFrame((...s)=>{this.isValid&&t(...s)});return this.onInvalidated(()=>cancelAnimationFrame(r)),r}requestIdleCallback(t,r){const s=requestIdleCallback((...n)=>{this.signal.aborted||t(...n)},r);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(t,r,s,n){r==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(r.startsWith("wxt:")?ae(r):r,s,{...n,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),mt.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:J.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){const r=t.data?.type===J.SCRIPT_STARTED_MESSAGE_TYPE,s=t.data?.contentScriptName===this.contentScriptName,n=!this.receivedMessageIds.has(t.data?.messageId);return r&&s&&n}listenForNewerScripts(t){let r=!0;const s=n=>{if(this.verifyScriptStartedEvent(n)){this.receivedMessageIds.add(n.data.messageId);const i=r;if(r=!1,i&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}}const ft=Symbol("null");let ht=0;class At extends Map{constructor(){super(),this._objectHashes=new WeakMap,this._symbolHashes=new Map,this._publicKeys=new Map;const[t]=arguments;if(t!=null){if(typeof t[Symbol.iterator]!="function")throw new TypeError(typeof t+" is not iterable (cannot read property Symbol(Symbol.iterator))");for(const[r,s]of t)this.set(r,s)}}_getPublicKeys(t,r=!1){if(!Array.isArray(t))throw new TypeError("The keys parameter must be an array");const s=this._getPrivateKey(t,r);let n;return s&&this._publicKeys.has(s)?n=this._publicKeys.get(s):r&&(n=[...t],this._publicKeys.set(s,n)),{privateKey:s,publicKey:n}}_getPrivateKey(t,r=!1){const s=[];for(let n of t){n===null&&(n=ft);const i=typeof n=="object"||typeof n=="function"?"_objectHashes":typeof n=="symbol"?"_symbolHashes":!1;if(!i)s.push(n);else if(this[i].has(n))s.push(this[i].get(n));else if(r){const g=`@@mkm-ref-${ht++}@@`;this[i].set(n,g),s.push(g)}else return!1}return JSON.stringify(s)}set(t,r){const{publicKey:s}=this._getPublicKeys(t,!0);return super.set(s,r)}get(t){const{publicKey:r}=this._getPublicKeys(t);return super.get(r)}has(t){const{publicKey:r}=this._getPublicKeys(t);return super.has(r)}delete(t){const{publicKey:r,privateKey:s}=this._getPublicKeys(t);return!!(r&&super.delete(r)&&this._publicKeys.delete(s))}clear(){super.clear(),this._symbolHashes.clear(),this._publicKeys.clear()}get[Symbol.toStringTag](){return"ManyKeysMap"}get size(){return super.size}}new At;function Et(){}function Z(e,...t){}const pt={debug:(...e)=>Z(console.debug,...e),log:(...e)=>Z(console.log,...e),warn:(...e)=>Z(console.warn,...e),error:(...e)=>Z(console.error,...e)};return(async()=>{try{const{main:e,...t}=it,r=new J("tiktok",t);return await e(r)}catch(e){throw pt.error('The content script "tiktok" crashed on startup!',e),e}})()}();
tiktok;
