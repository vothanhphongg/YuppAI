var background=function(){"use strict";function q(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var N={exports:{}},H=N.exports,U;function W(){return U||(U=1,function(l,D){(function(P,S){S(l)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:H,function(P){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)P.exports=globalThis.browser;else{const S="The message port closed before a response was received.",M=y=>{const I={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(I).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class v extends WeakMap{constructor(r,i=void 0){super(i),this.createItem=r}get(r){return this.has(r)||this.set(r,this.createItem(r)),super.get(r)}}const s=e=>e&&typeof e=="object"&&typeof e.then=="function",t=(e,r)=>(...i)=>{y.runtime.lastError?e.reject(new Error(y.runtime.lastError.message)):r.singleCallbackArg||i.length<=1&&r.singleCallbackArg!==!1?e.resolve(i[0]):e.resolve(i)},o=e=>e==1?"argument":"arguments",n=(e,r)=>function(g,...x){if(x.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${o(r.minArgs)} for ${e}(), got ${x.length}`);if(x.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${o(r.maxArgs)} for ${e}(), got ${x.length}`);return new Promise((b,E)=>{if(r.fallbackToNoCallback)try{g[e](...x,t({resolve:b,reject:E},r))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),g[e](...x),r.fallbackToNoCallback=!1,r.noCallback=!0,b()}else r.noCallback?(g[e](...x),b()):g[e](...x,t({resolve:b,reject:E},r))})},f=(e,r,i)=>new Proxy(r,{apply(g,x,b){return i.call(x,e,...b)}});let p=Function.call.bind(Object.prototype.hasOwnProperty);const c=(e,r={},i={})=>{let g=Object.create(null),x={has(E,a){return a in e||a in g},get(E,a,T){if(a in g)return g[a];if(!(a in e))return;let d=e[a];if(typeof d=="function")if(typeof r[a]=="function")d=f(e,e[a],r[a]);else if(p(i,a)){let O=n(a,i[a]);d=f(e,e[a],O)}else d=d.bind(e);else if(typeof d=="object"&&d!==null&&(p(r,a)||p(i,a)))d=c(d,r[a],i[a]);else if(p(i,"*"))d=c(d,r[a],i["*"]);else return Object.defineProperty(g,a,{configurable:!0,enumerable:!0,get(){return e[a]},set(O){e[a]=O}}),d;return g[a]=d,d},set(E,a,T,d){return a in g?g[a]=T:e[a]=T,!0},defineProperty(E,a,T){return Reflect.defineProperty(g,a,T)},deleteProperty(E,a){return Reflect.deleteProperty(g,a)}},b=Object.create(e);return new Proxy(b,x)},A=e=>({addListener(r,i,...g){r.addListener(e.get(i),...g)},hasListener(r,i){return r.hasListener(e.get(i))},removeListener(r,i){r.removeListener(e.get(i))}}),C=new v(e=>typeof e!="function"?e:function(i){const g=c(i,{},{getContent:{minArgs:0,maxArgs:0}});e(g)}),u=new v(e=>typeof e!="function"?e:function(i,g,x){let b=!1,E,a=new Promise(R=>{E=function(w){b=!0,R(w)}}),T;try{T=e(i,g,E)}catch(R){T=Promise.reject(R)}const d=T!==!0&&s(T);if(T!==!0&&!d&&!b)return!1;const O=R=>{R.then(w=>{x(w)},w=>{let j;w&&(w instanceof Error||typeof w.message=="string")?j=w.message:j="An unexpected error occurred",x({__mozWebExtensionPolyfillReject__:!0,message:j})}).catch(w=>{console.error("Failed to send onMessage rejected reply",w)})};return O(d?T:a),!0}),k=({reject:e,resolve:r},i)=>{y.runtime.lastError?y.runtime.lastError.message===S?r():e(new Error(y.runtime.lastError.message)):i&&i.__mozWebExtensionPolyfillReject__?e(new Error(i.message)):r(i)},h=(e,r,i,...g)=>{if(g.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${o(r.minArgs)} for ${e}(), got ${g.length}`);if(g.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${o(r.maxArgs)} for ${e}(), got ${g.length}`);return new Promise((x,b)=>{const E=k.bind(null,{resolve:x,reject:b});g.push(E),i.sendMessage(...g)})},B={devtools:{network:{onRequestFinished:A(C)}},runtime:{onMessage:A(u),onMessageExternal:A(u),sendMessage:h.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:h.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},F={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return I.privacy={network:{"*":F},services:{"*":F},websites:{"*":F}},c(y,B,I)};P.exports=M(chrome)}})}(N)),N.exports}var G=W();const $=q(G);function K(l){return l==null||typeof l=="function"?{main:l}:l}const m=typeof $<"u"?$:typeof chrome<"u"?chrome:null,z=K(()=>{function l(){m.contextMenus.removeAll().then(()=>{[{title:"Pick the OCR Type",id:"ocrid",contexts:["page"]},{title:"Pick the OCR image element",id:"ocrPicker",contexts:["page"]},{title:"Pick the input element",id:"inputPicker",contexts:["page"]},{title:"Probot",parentId:"ocrid",id:"probot",contexts:["page"]},{title:"Amazon",parentId:"ocrid",id:"amazon",contexts:["page"]}].forEach(t=>{m.contextMenus.create(t,()=>{m.runtime.lastError&&console.error("Context menu creation error:",m.runtime.lastError)})})}).catch(s=>console.error("Error removing context menus:",s))}m.contextMenus.onClicked.addListener((s,t)=>{if(!t?.id)return;const o={menuItemId:s.menuItemId,...s.menuItemId==="ocrPicker"&&{picker:"ocrPicker"},...s.menuItemId==="inputPicker"&&{picker:"inputPicker"}};m.tabs.sendMessage(t.id,o,n=>{m.runtime.lastError&&console.error("Message sending error:",m.runtime.lastError)})});const D={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36",Accept:"image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8","Accept-Language":"en-US,en;q=0.9","Sec-Fetch-Mode":"no-cors"};m.runtime.onMessage.addListener((s,t,o)=>{if(s.type==="GET_IMAGE_BASE64"){const{url:n,headers:f={}}=s.payload,p={...D,...f};return fetch(n,{headers:p}).then(c=>c.arrayBuffer()).then(c=>{const A=new Uint8Array(c).reduce((k,h)=>k+String.fromCharCode(h),""),u=`${btoa(A)}`;o({success:!0,data:u})}).catch(c=>{o({success:!1,error:c.message})}),!0}if(s.type==="networkRequest")return S(s.payload).then(n=>o({success:!0,data:n})).catch(n=>o({success:!1,error:n.message})),!0;if(s.type==="feedback")return fetch("https://feedback.captchasonic.com/reportAccuracy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s.payload)}).then(n=>n.json()).then(n=>{o({success:!0,data:n})}).catch(n=>{o({success:!1,error:n.message})}),!0;if(s.action==="getTabId")return t.tab?o({tabId:t.tab.id}):chrome.tabs.query({active:!0,currentWindow:!0},n=>{const f=n[0]?.id||null;o({tabId:f})}),!0;if(s.type==="whileLoopCheck")return chrome.tabs.query({active:!0,currentWindow:!0},n=>{n[0]&&o({message:"globalCallback"})}),!0;if(s.action==="solveTurnstile")return P(s.payload).then(n=>{o({success:!0,data:n})}).catch(n=>o({success:!1,error:n.message})),!0;if(s.action==="getActiveTabUrl")return chrome.tabs.query({active:!0,currentWindow:!0},n=>{const f=n[0];o({url:f.url})}),!0;if(s.type==="triggerCallback"){const n=t.tab?.id;return n&&m.tabs.sendMessage(n,{action:"executeCallback",callbackName:s.callbackName}),!0}s.action&&new Set(["popularCaptcha_refresh_iframes","ReCaptcha_refresh_iframes","ERROR_BAD_PARAMETERS","ERROR_TOO_BIG_CAPTCHA_FILESIZE","ERROR_ZERO_CAPTCHA_FILESIZE","ERROR_CAPTCHA_UNSOLVABLE","ERROR_BAD_IMGINSTRUCTIONS","ERROR_BAD_DUPLICATES","ERROR_NO_SUCH_METHOD","ERROR_KEY_DOES_NOT_EXIST","ERROR_ZERO_BALANCE","ERROR_DAILY_LIMIT_EXCEEDED","ERROR_QUOTA_LIMIT_EXCEEDED","ERROR_MINUTE_LIMIT_EXCEEDED"]).has(s.action)&&M(s.action)});async function P({websiteURL:s,websiteKey:t,userAgent:o}){const n="",p=await(await fetch("https://api.captchasonic.com/createTask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:n,task:{type:"AntiTurnstileTaskProxyLess",websiteURL:s,websiteKey:t,userAgent:o}})})).json();if(!p.taskId)throw new Error("Failed to create CAPTCHA task: "+JSON.stringify(p));const c=p.taskId,A=20,C=3e3;let u=0;for(;u<A;){const h=await(await fetch("https://api.captchasonic.com/getTaskResult",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:n,taskId:c})})).json();if(h.status==="ready")return h.solution;if(h.status==="failed")throw new Error("CAPTCHA solving failed.");await new Promise(B=>setTimeout(B,C)),u++}throw new Error("CAPTCHA solving timed out.")}async function S({url:s,method:t,headers:o,body:n}){const f=await fetch(s,{method:t||"GET",headers:o||{},body:t!=="GET"?n:void 0});if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);return f.headers.get("content-type")?.includes("application/json")?await f.json():await f.text()}async function M(s){try{const[t]=await m.tabs.query({active:!0,currentWindow:!0});if(!t?.id)return;await m.tabs.sendMessage(t.id,s)}catch(t){console.error("Error querying active tab:",t)}}async function y(){try{const s=await fetch(m.runtime.getURL("config/defaultConfig.json"));return s.ok?await s.json():null}catch(s){return console.error("Error loading default config:",s),null}}m.runtime.onInstalled.addListener(async s=>{l();const t=await y();if(s.reason==="install"){const o=await I();try{let n=await m.storage.local.get("userID");await m.storage.local.set({userID:o}),v("install",o)}catch(n){console.error("Error accessing storage:",n)}t&&await m.storage.local.set({settings:t}),t.GUIDE_PAGE}if(s.reason==="update"){let C=function(u,k){return u=u.filter(h=>k.includes(h)),k.forEach(h=>{u.includes(h)||u.push(h)}),u};const o=await I();try{let u=await m.storage.local.get("userID");await m.storage.local.set({userID:o}),v("update",o)}catch(u){console.error("Error accessing storage:",u)}const n=await m.storage.local.get("settings"),f=await m.storage.sync.get("settings"),c=(n?.settings?n:f).settings||{};let A={...t};A.APIKEY=t.APIKEY||c.APIKEY||"",A.ACTIVE=c.ACTIVE??t.ACTIVE,A.THEME=c.THEME||t.THEME,A.BLACKLISTENABLED=c.BLACKLISTENABLED??t.BLACKLISTENABLED,A.AUTOOPENENABLED=c.AUTOOPENENABLED??t.AUTOOPENENABLED,A.LOGENABLED=c.LOGENABLED??t.LOGENABLED,A.Local_lang=c.Local_lang||t.Local_lang,A.NOTIFICATION=c.NOTIFICATION??t.NOTIFICATION,A.CAPTCHAS=C(c.CAPTCHAS||[],t.CAPTCHAS),A.TITLES=C(c.TITLES||[],t.TITLES),A.OPTIONS={...c.OPTIONS};for(const u of Object.keys(t.OPTIONS))A.OPTIONS[u]?A.OPTIONS[u]={...t.OPTIONS[u],...c.OPTIONS[u]}:A.OPTIONS[u]=t.OPTIONS[u];await m.storage.local.set({settings:A}),console.log("Extension updated - settings merged successfully")}});async function I(){let s={browser:navigator.userAgent,platform:navigator.platform,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,cpuCores:navigator.hardwareConcurrency||"unknown",deviceMemory:navigator.deviceMemory||"unknown",installTimestamp:Date.now()};return btoa(JSON.stringify(s))}async function v(s,t){try{const o=await fetch("https://api.captchasonic.com/collect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:s,userID:t,timestamp:Date.now()})});o.ok||console.error(`Failed to send ${s} event:`,o.status)}catch(o){console.error(`Error sending ${s} event:`,o)}}m.runtime.onStartup.addListener(()=>{console.log("Extension initialized")})});function V(){}function L(l,...D){}const Z={debug:(...l)=>L(console.debug,...l),log:(...l)=>L(console.log,...l),warn:(...l)=>L(console.warn,...l),error:(...l)=>L(console.error,...l)};let _;try{_=z.main(),_ instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(l){throw Z.error("The background crashed on startup!"),l}return _}();
background;
